<!DOCTYPE html>
@{
    Layout = "~/Views/Shared/_LayoutMobile.cshtml";

}
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>โปรโมชั่น</title>
    @*<meta name="viewport" content="width=1024, initial-scale=1, shrink-to-fit=no">*@
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@300;400;600;700;800&display=swap" rel="stylesheet">
    <!--<link rel="stylesheet" href="~/dashboard/assets/css/bootstrap.css">-->
    <link href="~/dashboard/assets/vendors/iconly/broken.css" rel="stylesheet" />

    <link rel="stylesheet" href="~/dashboard/assets/vendors/perfect-scrollbar/perfect-scrollbar.css">
    <link rel="stylesheet" href="~/dashboard/assets/vendors/bootstrap-icons/bootstrap-icons.css">
    <link rel="stylesheet" href="~/dashboard/assets/css/app.css">
    <link rel="shortcut icon" href="~/dashboard/assets/images/favicon.svg" type="image/x-icon">

    <link href="~/bootstrap-select-1.13.14/dist/css/bootstrap-select.css" rel="stylesheet" />
    <script src="~/contentfilter/js/jquery-2.1.1.js"></script>
    <script src="~/contentfilter/js/jquery.mixitup.min.js"></script>
    <!-- <script src="~/contentfilter/js/main.js"></script> -->     <!-- Resource jQuery -->

    <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">

    <link href="~/Content/Normalize.css" rel="stylesheet" />
    <script src="~/Scripts/webAddress.js"></script>
    <script src="~/CSS/jQueryv3.1.1.js"></script>

    <script src="~/Scripts/carousel-slider/js/jssor.slider-28.1.0.min.js"></script>


    <style>
        .selected {
            background: #ACE2E1;
            color: #FFFFFF;
        }

        .removeselected {
            color: #fff !important;
            background-color: #000 !important;
        }

        .puick-contact-area {
            background: #f6f6f6 none repeat scroll 0 0;
            padding: 40px 0;
            text-align: center;
            width: 370px;
        }

        .contact-btn .fv-btn:hover {
            border: 1px solid #ff4136;
            color: #fff;
            background: #ff4136;
        }

        .contact-btn .fv-btn {
            background: transparent none repeat scroll 0 0;
            border: 1px solid #d5d5d5;
            color: #4b4b4b;
            font-size: 14px;
            height: 45px;
            letter-spacing: 2px;
            line-height: 45px;
            padding: 0 70px;
            text-transform: uppercase;
            transition: all 0.3s ease 0s;
        }

        .section-title-2 {
            color: #555555;
            display: inline-block;
            font-size: 18px;
            font-weight: 600;
            padding-bottom: 14px;
            position: relative;
            text-transform: uppercase;
        }

        .ppp {
            font-family: 'Poppins', sans-serif;
            color: #303030;
            font-weight: 400;
            font-size: 12px;
            line-height: 12px;
            margin-bottom: 8px;
        }

        .statusamt {
            display: none;
        }

        .statusamtchild {
            display: none;
        }

        .statuspromotion {
            display: none;
        }

        .statuscliamoffon {
            display: none;
        }

        .statusbackord {
            display: none;
        }

        .statusTop20 {
            display: none;
        }
        /*.w3-black, .w3-hover-black:hover {
            color: #1c1818 !important;
            background-color: #b7b7bc !important;
        }*/
    </style>
    <style>
        .switch {
            position: relative;
            display: inline-block;
            /*width: 60px;
            height: 34px;*/
            width: 54px;
            height: 25px;
            float: right;
        }

            .switch input {
                opacity: 0;
                width: 0;
                height: 0;
            }

        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            -webkit-transition: .4s;
            transition: .4s;
            border-radius: 32px;
        }

            .slider:before {
                position: absolute;
                content: "";
                /*height: 26px;
                width: 26px;*/
                width: 20px;
                height: 20px;
                left: 4px;
                bottom: 4px;
                background-color: white;
                -webkit-transition: .4s;
                transition: .4s;
                border-radius: 30px;
            }

        input:checked + .slider {
            background-color: #2196F3;
        }

        input:focus + .slider {
            box-shadow: 0 0 1px #2196F3;
        }

        input:checked + .slider:before {
            -webkit-transform: translateX(26px);
            -ms-transform: translateX(26px);
            transform: translateX(26px);
        }

        /* Rounded sliders */
        .slider.round {
            border-radius: 34px;
        }

            .slider.round:before {
                border-radius: 50%;
            }
    </style>

    <style>


        h5 {
            font-size: 1.28571429em;
            font-weight: 700;
            line-height: 1.2857em;
            margin: 0;
        }

        .card {
            font-size: 1em;
            overflow: hidden;
            padding: 0;
            border: none;
            border-radius: .28571429rem;
            box-shadow: 0 1px 3px 0 #d4d4d5, 0 0 0 1px #d4d4d5;
        }

        .card-block {
            font-size: 1em;
            position: relative;
            margin: 0;
            padding: 1em;
            border: none;
            border-top: 1px solid rgba(34, 36, 38, .1);
            box-shadow: none;
        }

        .card-img-top {
            display: block;
            width: 100%;
            height: auto;
        }

        .card-title {
            font-size: 1.28571429em;
            font-weight: 700;
            line-height: 1.2857em;
        }

        .card-text {
            clear: both;
            margin-top: .5em;
            display: flexbox;
            color: rgba(0, 0, 0, .68);
        }

        .card-footer {
            font-size: 1em;
            position: static;
            top: 0;
            left: 0;
            max-width: 100%;
            padding: .75em 1em;
            color: rgba(0, 0, 0, .4);
            border-top: 1px solid rgba(0, 0, 0, .05) !important;
            background: #fff;
        }

        .card-inverse .btn {
            border: 1px solid rgba(0, 0, 0, .05);
        }

        .profile {
            position: absolute;
            top: -12px;
            display: inline-block;
            overflow: hidden;
            box-sizing: border-box;
            width: 25px;
            height: 25px;
            margin: 0;
            border: 1px solid #fff;
            border-radius: 50%;
        }

        .profile-avatar {
            display: block;
            width: 100%;
            height: 100%;
            border-radius: 50%;
        }

        .profile-inline {
            position: relative;
            top: 0;
            display: inline-block;
        }

            .profile-inline ~ .card-title {
                display: inline-block;
                margin-left: 4px;
                vertical-align: top;
            }

        .text-bold {
            font-weight: 700;
        }

        .meta {
            font-size: 1em;
            color: rgba(0, 0, 0, .4);
        }

            .meta a {
                text-decoration: none;
                color: rgba(0, 0, 0, .4);
            }

                .meta a:hover {
                    color: rgba(0, 0, 0, .87);
                }
        /* Dropdown Button */

        .dropbtn {
            /* background-color: #04AA6D; */
            color: #075896;
            padding: 7px;
            font-size: 16px;
            border: none;
        }
        /* The container <div> - needed to position the dropdown content */
        .dropdown {
            position: relative;
            display: inline-block;
        }

        /* Dropdown Content (Hidden by Default) */
        /*.dropdown-content {
            display: none;
            position: absolute;
            background-color: #3570b6;
            min-width: 160px;
            box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
            z-index: 999;
            position: relative;
        }*/
        .dropdown-content {
            display: none;
            position: absolute;
            background-color: #b1bfce;
            min-width: 160px;
            box-shadow: 0px 8px 16px 0px rgb(0 0 0 / 20%);
            z-index: 999;
            position: relative;
        }
            /* Links inside the dropdown */
            .dropdown-content a {
                color: black;
                padding: 12px 16px;
                text-decoration: none;
                display: block;
            }

                /* Change color of dropdown links on hover */
                .dropdown-content a:hover {
                    background-color: #ddd;
                }

        /* Show the dropdown menu on hover */
        .dropdown:hover .dropdown-content {
            display: block;
        }

        /* Change the background color of the dropdown button when the dropdown content is shown */
        .dropdown:hover .dropbtn {
            background-color: #bee0ed;
        }

        .font-kanit {
            font-family: Kanit, sans-serif;
        }
    </style>
    <style>
        .footer {
            position: relative;
            left: 0;
            bottom: 0;
            width: 100%;
            color: white;
            text-align: center;
        }

        #loader {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 9999; /* กำหนดให้มีลำดับการแสดงอยู่เหนือส่วนอื่น */
            background-color: rgba(255, 255, 255, 0.8); /* สีพื้นหลังของ loader */
            padding: 20px;
        }

        .loader {
            border: 16px solid #f3f3f3;
            border-radius: 50%;
            border-top: 16px solid #3498db;
            width: 120px;
            height: 120px;
            -webkit-animation: spin 2s linear infinite; /* Safari */
            animation: spin 2s linear infinite;
            position: relative; /* or absolute */
        }
        /* Safari */
        @@-webkit-keyframes spin {
            0% {
                -webkit-transform: rotate(0deg);
            }

            100% {
                -webkit-transform: rotate(360deg);
            }
        }

        @@keyframes spin {
            0% {
                transform: rotate(0deg);
            }

            100% {
                transform: rotate(360deg);
            }
        }
    </style>
</head>

<body style="background-color: #f2f7ff; ">
    <div id="app">
        <div id="main" style=" padding-right: 20px; padding-left: 20px; font-family: Kanit, sans-serif;">
            <div class="page-heading">
                <div>
                    <input type="hidden" id="cushid" />
                    <input type="hidden" id="slmhid" />
                    <input type="hidden" id="nocusses" />
                    <input class="note-desc" id="cussend" type="hidden">
                </div>
                <br />

            </div>

            <div class="page-content">
                <div class="container" id="loader">
                    <div class="d-flex justify-content-center">
                        <div class="loader"></div>
                    </div>
                    <div class="text-center">
                        <h3>Loading...</h3>
                    </div>
                </div>
                <section class="row justify-content-center d-none" id="content" hidden>
                    <div class="col-12 col-lg-4" id="cushead">
                        <div class="row">
                            <p id="demo"></p>
                            <div class="col-12 caption">
                                <div class="card">
                                    <div class="card-header">
                                        <h4 id="h2title">กรุณาเลือก พนักงานขาย / ลูกค้า</h4>
                                    </div>
                                    <div class="card-body">
                                        <div class="form-group">
                                            <div class="input-group ">
                                                <select class="form-control custom-select" id="selslm">
                                                </select>
                                            </div>
                                        </div>
                                        <span style="font-family: Kanit, sans-serif; color: blue; cursor: pointer;" id="btnclear" class="fa fa-map-marked">เคลียร์ข้อมูลหน้าจอเป็นค่าเริ่มต้น</span>
                                        <br />
                                        <div id="prvs">
                                            <h8>ลูกค้า</h8>
                                            <div>
                                                <select class="selectpicker form-control" data-container="body" data-live-search="true" title="เลือกลูกค้า" data-hide-disabled="true" id="selcus"></select>
                                            </div>

                                            <div class="single-checkout-box select-option mt--10">
                                                <button type="button" class="btn-gray font-kanit" id="btnshsche">กดค้นหาลูกค้ากรณีไม่ทราบพนักงานขาย</button>
                                            </div>
                                            <div class="single-checkout-box checkbox">

                                            </div>

                                        </div>
                                        <div class="appendbtnshopbysales"></div>
                                    </div>

                                </div>

                            </div>
                        </div>
                        <div id="appadjall"></div>
                    </div>

                    <div class="col-12 col-lg-8">
                        <div id="dfch">
                            @*Promotion*@
                            <div class="row">
                                <div class="col-12">
                                    <!-- Rounded switch -->
                                    <div class="card">
                                        <div class="card-header">
                                            <div class="col-sm-6 text-left">
                                                <h4>โปรโมชั่น</h4>
                                            </div>
                                            <div class="col-sm-6 text-right" hidden>
                                                <label class="switch">
                                                    <input type="checkbox">
                                                    <span class="slider" id="promooffon"></span>
                                                </label><div class='statuspromotion'>Untoggled</div>
                                            </div>
                                        </div>
                                        <div class="w3-bar w3-round bg-info opacity-75">
                                            <button class="w3-bar-item w3-button btnpromotion font-kanit" onclick="openPeriod('yearly',this.id)" id="btn_yearly">โปรโมชั่นรายปี</button>
                                            <button class="w3-bar-item w3-button btnpromotion font-kanit" onclick="openPeriod('quater', this.id)" id="btn_quater">โปรโมชั่นรายไตรมาส</button>
                                            <button class="w3-bar-item w3-button btnpromotion font-kanit" onclick="openPeriod('other', this.id)" id="btn_other">โปรโมชั่นรายเดือน</button>
                                        </div>
                                        <div class="card">
                                            <div id="yearly" class="city">

                                                <div class="table-responsive">
                                                    <table class="table table-striped mb-0" id="promotiontbyearly" style="padding: 7px; font-size: small; overflow: auto;">
                                                        <thead style="font-size: small;">
                                                            <tr>
                                                                <th>โปรโมชั่น</th>
                                                                <th>เงื่อนไข</th>
                                                                @*<th>จาก</th>*@
                                                                <th>สิ้นสุด</th>
                                                                <th>ยอดซื้อ</th>
                                                                <th>ยังขาดอีก</th>
                                                                <th>ของรางวัล</th>
                                                            </tr>
                                                        </thead>
                                                        <tbody></tbody>
                                                    </table>
                                                </div>
                                            </div>

                                            <div id="quater" class="city" style="display:none">
                                                <div class="table-responsive">
                                                    <table class="table table-striped mb-0" id="promotiontbquater" style="padding: 7px; font-size: small; overflow: auto;">
                                                        <thead style="font-size: small;">
                                                            <tr>
                                                                <th>โปรโมชั่น</th>
                                                                <th>เงื่อนไข</th>
                                                                @* <th>จาก</th>*@
                                                                <th>สิ้นสุด</th>
                                                                <th>ยอดซื้อ</th>
                                                                <th>ยังขาดอีก</th>
                                                                <th>ของรางวัล</th>
                                                            </tr>
                                                        </thead>
                                                        <tbody></tbody>
                                                    </table>
                                                </div>
                                            </div>

                                            <div id="other" class="city" style="display:none">
                                                <table class="table table-striped mb-0" id="promotiontbother" style="padding: 7px;font-size: small; overflow:auto;">
                                                    <thead style="font-size: small;">
                                                        <tr>
                                                            <th>โปรโมชั่น</th>
                                                            <th>เงื่อนไข</th>
                                                            @*<th>จาก</th>*@
                                                            <th>สิ้นสุด</th>
                                                            <th>ยอดซื้อ</th>
                                                            <th>ยังขาดอีก</th>
                                                            <th>ของรางวัล</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody></tbody>
                                                </table>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                        </div>
                        <div id="appadj"></div>
                    </div>
                </section>
            </div>
        </div>

        <div class="modal" id="ExtraLargeModalLabel">
            <div class="modal-dialog modal-lg">
                <div class="alert alert-light alert-dismissible" role="alert">
                    <button type="button" class="close" data-dismiss="modal" aria-label=" close"><span aria-hidden="true">&times;</span></button>
                    <strong>สินค้าใหม่!</strong>
                    <div class="modal-body">
                        <div class="container">

                            <div class="row" id="fixboxs">






                            </div>
                        </div>


                    </div>

                </div>
            </div>
        </div>


        <!-- ModalWarning -->
        <div class="modal" id="myModalWarning">
            <div class="modal-dialog">
                <div class="alert alert-warning alert-dismissible" role="alert">
                    <button type="button" class="close" data-dismiss="modal" aria-label=" close"><span aria-hidden="true">&times;</span></button>
                    <strong>Warning!</strong>
                    <div class="modal-body">
                        <div id="textAlertWarning">Some text in the modal.</div>
                    </div>

                </div>
            </div>
        </div>
        <div class="modal" id="smallModal">
            <div class="modal-dialog">

                <div class="modal-content">
                    <button type="button" class="close" data-dismiss="modal" style=" margin-left: auto;">
                        &times;
                    </button>
                    <div class="modal-header">

                    </div>

                    <div class="modal-body">
                        ต้องการเปลี่ยนเป็นร้านค้า<span id="cusselectpop"></span> หรือไม่
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-dismiss="modal" id="btnnot">ไม่ต้องการ</button>
                        <button type="button" class="btn btn-primary" id="btnok">ต้องการ</button>
                    </div>

                </div>
            </div>
        </div>
        <div class="modal" id="smallModalselcus">
            <div class="modal-dialog">

                <div class="modal-content">
                    <button type="button" class="close" data-dismiss="modal" style=" margin-left: auto;">
                        &times;
                    </button>
                    <div class="modal-header">

                    </div>

                    <div class="modal-body">
                        ใส่ชื่อร้านหรือรหัสร้านค้า
                        <div id="blcslm" style="display:block">
                            <input type="search" id="textfree" class="form-control ui-autocomplete-input" autocomplete="off">
                        </div>
                    </div>
                    <div class="modal-footer">

                    </div>

                </div>
            </div>
        </div>
        <!-- ModalWarning -->
        <!-- ModalwConfirm -->
        <div id="ModalwConfirm" class="modal">
            <div class="modal-dialog">

                <!-- Modal content-->
                <div class="modal-content " id="ColorboxError">
                    <button type="button" class="close" data-dismiss="modal" style=" margin-left: auto;">
                        &times;
                    </button>
                    <h4 class="modal-title" style="color:black;">สินค้าค้างในตะกร้า</h4>

                    <div class="modal-body" style="overflow-y: scroll;overflow-x: scroll;">
                        <div id="textAlert">
                            <table class="table table-bordered" id="wConfirm">
                                <thead style="background-color: rgb(51, 51, 51);color: white;">
                                    <tr>
                                        <th>Customer</th>
                                        <th>Salesman</th>
                                        <th>จำนวนชิ้น</th>
                                    </tr>
                                </thead>
                            </table>
                        </div>
                    </div>

                    <div class="modal-footer">

                        <button type="button" class="btn btn-default" id="CancalShippto" data-dismiss="modal">X</button>

                        <!--<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>-->
                    </div>
                </div>

            </div>
        </div>
        @*Modal date expire*@
        <div class="modal" id="myModalWarningDateExpire" role="dialog" data-backdrop="static" data-keyboard="false">
            <div class="modal-dialog">
                <div class="alert alert-warning alert-dismissible" role="alert">
                    <button type="button" class="close" data-dismiss="modal" aria-label=" close"><span aria-hidden="true">&times;</span></button>
                    <strong>แจ้งเตือน!</strong>
                    <div class="modal-body">
                        <div id="textAlertWarningDateExpire">Some text in the modal.</div>
                    </div>

                </div>
            </div>
        </div>
        <!-- EndModalwConfirm-->

        <div class="modal" id="myModalclimtb">
            @*<div class="modal fade bd-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true">*@
            <div class="modal-dialog modal-lg">

                <div class="modal-content">
                    <button type="button" class="close" data-dismiss="modal" style=" margin-left: auto;">
                        &times;
                    </button>
                    <strong style="padding: 4px;">รายละเอียดงานเคลม</strong>
                    <div class="table-responsive" style="height: 500px; padding: 6px;">
                        <table class="table table-striped mb-0" id="climtbdatail" style="padding: 7px;font-size: small;">
                            <thead style="font-size: small;">
                                <tr>
                                    <th>เลขเคลม</th>
                                    <th>เบอร์สินค้า</th>
                                    <th>จำนวน</th>
                                    <th>วันที่แจ้งเคลม</th>
                                    <th>วันที่รับเคลม</th>
                                    <th>ต้องการให้ดำเนิน</th>
                                    <th>สถานะเคลม</th>
                                </tr>
                            </thead>
                            <tbody></tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <div class="modal" id="myModal" style="background-color: black;">

            <div class="modal-dialog" role="document" style="width: 360px;">

                <div class="modal-content">

                    <div class="modal-header" style="background-color: #337AB7; padding: 16px 16px; color: #FFF; border-bottom: 2px dashed #337AB7; ">

                        @*<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button>*@

                        <h4 class="modal-title" id="myModalLabel"></h4>

                    </div>

                    <div class="modal-body" id="texterror">
                    </div>

                    <div class="modal-footer">

                        @*<button type="button" class="btn btn btn-primary" data-dismiss="modal">OK</button>*@

                        <button type="button" class="btn btn btn-success" data-dismiss="modal" id="btnlogin">เข้าสู่ระบบอีกครั้ง</button>

                        @*<button type="button" class="btn btn-orange" data-dismiss="modal">Cancel</button>*@

                    </div>

                </div>

            </div>

        </div>
        <footer class="footer" hidden>
            <div class="container">
                <p>2024 &copy; TAC&AAC</p>
            </div>
        </footer>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    @*<script src="~/dashboard/assets/vendors/perfect-scrollbar/perfect-scrollbar.min.js"></script>
        <script src="~/dashboard/assets/js/bootstrap.bundle.min.js"></script*@
    <script src="~/dashboard/assets/vendors/apexcharts/apexcharts.js"></script>
    @*<script src="~/dashboard/assets/js/pages/dashboard.js"></script>*@
    @*<script src="~/dashboard/assets/js/main.js"></script>*@
    <script src="~/contentfilter/js/jquery-2.1.1.js"></script>
    <!-- <link href="~/bootstrap-select-1.13.14/Bootstrapv4.1.0.css" rel="stylesheet" />-->
    @*<script src="~/bootstrap-select-1.13.14/Bootstrapv4.1.0.js"></script>*@
    @*<script src="~/bootstrap-select-1.13.14/dist/js/bootstrap-select.js"></script>*@
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.14.7/dist/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
    <script src="~/bootstrap-select-1.13.14/dist/js/bootstrap-select.js"></script>
    <link href="~/tmartcss/JSautocomplete/jquery-ui.css" rel="stylesheet" />
    <script src="~/tmartcss/JSautocomplete/jquery-ui-1.9.2.js"></script>
    <script src="~/Scripts/webAddress.js"></script>
    <script src="~/Scripts/CheckFuntion/Loginexpire.js"></script>
    <script src="~/Scripts/carousel-slider/js/jssor.slider-28.1.0.min.js"></script>
    <link href="~/Scripts/carousel-slider/slides.css" rel="stylesheet" />
    <script type="text/javascript">

        var id = '@Request.RequestContext.HttpContext.Session["ID"]';
        var userid = '@Request.RequestContext.HttpContext.Session["UserID"]';
        var usertype = '@Request.RequestContext.HttpContext.Session["UserType"]';
        var usrexpire = '@Request.RequestContext.HttpContext.Session["expdatecal"]';
        var usrclmstaff = '@Request.RequestContext.HttpContext.Session["UsrClmStaff"]';
        var cuscod ='@Request.RequestContext.HttpContext.Session["CusCod"]';

        console.log("usertype = " + usertype + "usrexpire = " + usrexpire);
        $(document).ready(function () {
            $('#loader').show();
            setTimeout(function() {
                $('#loader').hide();
                $('#content').removeClass('d-none').addClass('d-flex');
                $('.footer').removeAttr('hidden');
            }, 2000);
        });

        if (cuscod != "") {
            $("#cushid").val(cuscod)
            getPromotion_Cus(cuscod, 'yearly');
        }
        //alert(cuscod);
        // var cuscod = atob(param_values.numcuber)
        //$(window).click(function (e) {
        //    alert(e.target.id); // gives the element's ID
        //    alert(e.target.className); // gives the elements class(es)
        //});
        //alert("id   " + id)
        function checkPrivilege(userid, cuscod) {
            $.ajax({
                url: '@Url.Action("GetdataPrivilege", "DataCenter")',
                data: {
                    UsrID: userid,
                    cuscod: cuscod

                },
                type: "POST",
                dataType: "JSON",
                success: function (data) {
                    var splitstring = data.StrStstuslogin;
                    //console.log(splitstring);
                    //let text = splitstring;
                    //const myArray = text.split("|");
                    //let mysession = myArray[1];
                    //let mystatus = myArray[0];
                    // console.log("mystatus " + mystatus + "//////" + "mysession " + mysession);
                    if (splitstring=="1") {
                        $("#texterror").empty();
                        $("#texterror").text("ขออภัย ท่านทำรายการเกินระยะเวลาที่กำหนด กรุณาเข้าใช้งานใหม่อีกครั้ง");
                        $("#myModal").modal();
                        return false;

                    }
                }
            });

        }
        @*
        function checklogin(userid, id) {
            $.ajax({
                url: '@Url.Action("GetdataSessionlogin", "DataCenter")',
                data: {
                    UsrID: userid,
                    SessionId: id

                },
                type: "POST",
                dataType: "JSON",
                success: function (data) {
                    var splitstring = data.StrStstuslogin;
                    //console.log(splitstring);
                    let text = splitstring;
                    const myArray = text.split("|");
                    let mysession = myArray[1];
                    let mystatus = myArray[0];
                   // console.log("mystatus " + mystatus + "//////" + "mysession " + mysession);
                    if (id != mysession) {
                        $("#texterror").empty();
                        $("#texterror").text("ขออภัย ท่านทำรายการเกินระยะเวลาที่กำหนด กรุณาเข้าใช้งานใหม่อีกครั้ง");
                        $("#myModal").modal();
                        return false;
                        //window.location.replace("../Account/LogIn");
                    } else {

                        if (mystatus == "0") {
                            $("#texterror").empty();
                            $("#texterror").text("ขออภัย ท่านทำรายการเกินระยะเวลาที่กำหนด กรุณาเข้าใช้งานใหม่อีกครั้ง");
                            $("#myModal").modal();
                            return false;
                            //window.location.replace("../Account/LogIn");
                        }
                    }
                }
            });

        }

        function checklogin(userid, id) {
            $.ajax({
                url: '@Url.Action("GetdataSessionlogin", "DataCenter")',
                data: {
                    UsrID: userid,
                    SessionId: id

                },
                type: "POST",
                dataType: "JSON",
                success: function (data) {
                    var splitstring = data.StrStstuslogin;
                    console.log(splitstring);
                    let text = splitstring;
                    const myArray = text.split("|");
                    let mysession = myArray[1];
                    let mystatus = myArray[0];
                   // console.log("mystatus " + mystatus + "//////" + "mysession " + mysession);
                    if (id != mysession) {
                       // alert("xxxx")
                        $("#texterror").empty();
                        $("#texterror").text("ขออภัย ท่านทำรายการเกินระยะเวลาที่กำหนด กรุณาเข้าใช้งานใหม่อีกครั้ง");
                        $("#myModal").modal();

                        return false;
                        //window.location.replace("../Account/LogIn");
                    } else {

                        if (mystatus == "0") {
                            $("#texterror").empty();
                            $("#texterror").text("ขออภัย ท่านทำรายการเกินระยะเวลาที่กำหนด กรุณาเข้าใช้งานใหม่อีกครั้ง");
                            $("#myModal").modal();
                            return false;
                            //window.location.replace("../Account/LogIn");
                        }
                    }
                }
            });

        }
        *@

        //var cuscod = "";
        if (usertype == "1") {
            $("#nextcheckstock").css("display", "block");
            $("#nextcrm").css("display", "block");
            $("#nextbck").css("display", "block");
            $("#changepass").css("display", "none");
        }
        if (usertype == "6") {
            if (cuscod != "") {
                checkPrivilege(userid, cuscod)
            }
            //$(window).on('load', function () {
            //    //alert("load")
            //    checklogin(userid, id)
            //});
            //window.onclick = function () {
            //    //alert("onclick")
            //    checklogin(userid, id)
            //};
            //$('.navbar-nav').click(function () {
            //   // alert("navbar-nav")
            //    checklogin(userid, id)

            //});
            //$('a').click(function () {
            //  //  alert("a")
            //    checklogin(userid, id)

            //});
            //$(document).bind('keypress.session', function (ed, e) {
            //    checklogin(userid, id)
            //});
            //$(document).bind('mousedown keydown', function (ed, e) {

            //    checklogin(userid, id)
            //});
            //$(window).scroll(function (e) {

            //    checklogin(userid, id)
            //});
            if (usrclmstaff == "1") {
                $("#amtdoffon").css("display", "none");
                $("#amtchildoffon").css("display", "none");
                $("#btnoffonTop20").css("display", "none");
                $("#promooffon").css("display", "none");

                $("#dfch").css("display", "block");
                $('#appadjall').html("");
            }
            else {
                $("#amtdoffon").css("display", "block");
                $("#amtchildoffon").css("display", "block");
                $("#btnoffonTop20").css("display", "block");
                $("#promooffon").css("display", "block");
                $("#dfch").css("display", "block");
                            $('#appadjall').html("");
            }
            $("#nextcheckstock").css("display", "none");
            $("#nextcrm").css("display", "none");
            $("#nextbck").css("display", "none");
            $("#changepass").css("display", "block");
            $(".aboutoffice").css("display", "none");
            $("#nextdas").css("display", "none");
            $("#desb").css("display", "none");
        }
        else {
            $("#dfch").css("display", "block");
            $('#appadjall8').html("");
        }

        if (usertype == "2") {
            $("#nextbck").css("display", "block");
            $("#changepass").css("display", "none");
            $("#nextcheckstock").css("display", "none");
            $("#nextcrm").css("display", "none");
        }
        n = new Date();
        y = n.getFullYear();
        m = n.getMonth() + 1;
        d = n.getDate();
        window.onload = function () {
            var script = document.createElement("script");
            script.type = "text/javascript";
            script.src = "https://api.ipify.org?format=jsonp&callback=DisplayIP";
            document.getElementsByTagName("head")[0].appendChild(script);
        };
        function DisplayIP(response) {
            //document.getElementById("ipaddress").innerHTML = "Your IP Address is " + response.ip;
            //alert(response.ip);
        }
        function jssor_1_slider_init() {

            var jssor_1_options = {
                $AutoPlay: 0,
                $AutoPlaySteps: 5,
                $SlideDuration: 260,
                $SlideWidth: 200,
                $SlideSpacing: 3,
                $ArrowNavigatorOptions: {
                    $Class: $JssorArrowNavigator$,
                    $Steps: 1
                },
                $BulletNavigatorOptions: {
                    $Class: $JssorBulletNavigator$,
                    $SpacingX: 16,
                    $SpacingY: 16
                }
            };

            var jssor_1_slider = new $JssorSlider$("jssor_1", jssor_1_options);

            /*#region responsive code begin*/

            var MAX_WIDTH = 758;

            function ScaleSlider() {

                var containerElement = jssor_1_slider.$Elmt.parentNode;
                var containerWidth = containerElement.clientWidth;

                if (containerWidth) {

                    var expectedWidth = Math.min(MAX_WIDTH || containerWidth, containerWidth);

                    jssor_1_slider.$ScaleWidth(expectedWidth);
                }
                else {
                    window.setTimeout(ScaleSlider, 30);
                }
            }

            ScaleSlider();

            $Jssor$.$AddEvent(window, "load", ScaleSlider);
            $Jssor$.$AddEvent(window, "resize", ScaleSlider);
            $Jssor$.$AddEvent(window, "orientationchange", ScaleSlider);


        };
        function getContinue_Newitwm() {
            //var stkcod = $("#_udernumber").val();
            var cuskey = $("#cushid").val();//checkcustomerบัญชีลูกค้า:
            var cuscod = cuskey;

            //var stkcod = stkcod;
            //$('#fixboxs').empty();

            $.ajax({
                url: '@Url.Action("GetdataContinue_Newitem", "DataCenter")',
                data: {
                    // Nodisplay: stkcod,
                    strcustome: cuscod
                },
                type: "POST",
                dataType: "JSON",
                success: function (data) {
                    console.log(data);
                    listnewitem = data;

                    $('#fixboxs').empty();
                    if (listnewitem.length > 0) {

                        var favitm = "";
                        var displ = "";
                        var displstr = "";
                        var displnew = "";
                        var displstrnew = "";
                        var newitem = "";
                        var strph = "";
                        var strphsrc = "";
                        var strtop = "";
                        var strtopint = 0;
                        var runtop;
                        var sprstkdes = "";
                        //$('.loader').css("display", "none");

                        for (var i = 0; i < listnewitem.length; i++) {
                            ItemNo = listnewitem[i].STKCOD;
                            Supdescri = listnewitem[i].Description;//.substr(0, 50);
                            Price = listnewitem[i].EndPrice;
                            Company = listnewitem[i].Company;
                            //Available_Stock = listnewitem[i].Stock;
                            strph = listnewitem[i].PATH;
                            strtopint = i;
                            runtop = strtopint + 1;

                            strtop = "";
                            if (Supdescri.length > 48) {

                                sprstkdes = Supdescri.substr(0, 48) + "...";

                            } else {
                                sprstkdes = Supdescri;
                            }

                            $("#fixboxs").append('<div class="col-sm-6 col-md-4 col-lg-4 mt-4">' +
                       '<div class="card">' +
                                    '<img class="card-img-top" src="' + strph + '" >' +
                                                                '<div class="card-block" style="height: 132px;">' +
                                                                    '<h4 class="card-title">' + ItemNo + '</h4>' +
                                                                    '<div class="meta">' +
                                                                       // '<a href="#">Friends</a>' +
                                                                    '</div>' +
                                                                    '<div class="card-text"> ' + sprstkdes + '</div>' +

                                                                '</div>' +
                                                                '<div class="card-footer">' +
                                                                    '<span class="float-right"><a href="#"  id="_btnlinkdetail" com=' + Company + ' stock="' + ItemNo + '" style="color: blue;">See Detail</a> </span>' +
                                                                    '<span><i class="">฿ ' + commaSeparateNumber(Price) + '</span>' +
                                                                '</div>' +
                                                            '</div>' +
                                                        '</div>');
                        }
                    } else {

                        $('#fixboxs').empty();
                    }
                }
            });
        }
        $(document).ready(function () {
            $(document).on("click", "#myModal", function () {
           // $('#myModal3').click(function () {
                if (usertype == "6") {
                    $("#myModal").modal({ backdrop: "static" });
                }
            });
            $('#btnlogin').click(function () {
                if (usertype == "6") {
                    window.location.replace("../Account/LogIn");
                }
            });
            $('#amtdoffon').click(function () {
                var current_status = $('.statusamt').text();

                var cuskey = $("#cushid").val();//checkcustomerบัญชีลูกค้า:
                if (current_status == 'Untoggled') {
                    $('.statusamt').html('Toggled');
                    getcuschamt(cuskey);
                }
                else {
                    $('.statusamt').html('Untoggled');
                    clearChartsamt();
                }
            });
            $('#amtchildoffon').click(function () {
                var current_status = $('.statusamtchild').text();

                var cuskey = $("#cushid").val();//checkcustomerบัญชีลูกค้า:
                if (current_status == 'Untoggled') {
                    $('.statusamtchild').html('Toggled');
                    getcuschamt_child(cuskey);
                }
                else {
                    $('.statusamtchild').html('Untoggled');
                    clearChartsamt_child();
                }
            });
            //TOP20
            $('#btnoffonTop20').click(function () {
                var current_status = $('.statusTop20').text();
                var cuscod = $("#cushid").val();
                if (current_status == 'Untoggled') {
                    $('.statusTop20').html('Toggled');
                    getListTop20(cuscod);
                } else {
                    $('.statusTop20').html('Untoggled');
                    $('#tableListTop20 tbody:last-child').html("");
                }
            });
           // $('#promooffon').click(function () {
           //     var current_status = $('.statuspromotion').text();

           //         var cuskey = $("#cushid").val();//checkcustomerบัญชีลูกค้า:
           //         if (current_status == 'Untoggled') {
           //             $('.statuspromotion').html('Toggled');
           //             getPromotion_Cus(cuskey, 'yearly')//โปรโมชั่น
           //         }
           //         else {
           //             $('.statuspromotion').html('Untoggled');

           //             $('#promotiontbyearly tbody:last-child').html("");
           //             $('#promotiontbquater tbody:last-child').html("");
           //             $('#promotiontbother tbody:last-child').html("");
           //         }
           //});
            $('#cliamoffon').click(function () {
                var current_status = $('.statuscliamoffon').text();

                var cuskey = $("#cushid").val();//checkcustomerบัญชีลูกค้า:
                if (current_status == 'Untoggled') {
                    $('.statuscliamoffon').html('Toggled');
                    getWarrantyClaim_Cu(cuskey) //WarrantyClaim
                }
                else {
                    $('.statuscliamoffon').html('Untoggled');
                    $('#climtb tbody:last-child').html("");

                }
            });
            $('#backordoffon').click(function () {
                var current_status = $('.statusbackord').text();

                var cuskey = $("#cushid").val();//checkcustomerบัญชีลูกค้า:
                if (current_status == 'Untoggled') {
                    $('.statusbackord').html('Toggled');
                    getbackord(cuskey)//backorder
                }
                else {
                    $('.statusbackord').html('Untoggled');
                    $('#backordtb tbody:last-child').html("");

                }
            });
            $('.button-left').click(function () {
                $('.sidebar').toggleClass('fliph');
            });
            $('li a .toggle__menu').on('click', function () {
                //alert("xxxx")
                $('.offsetmenu').addClass('offsetmenu__on');
                $('.body__overlay').addClass('is-visible');

            });
            $('.offsetmenu__close__btn').on('click', function () {
                $('.offsetmenu').removeClass('offsetmenu__on');
                // $('.body__overlay').removeClass('is-visible');
            });
            $("#selcus").on("change", function () {
                var cuscod = $("#selcus").val();
                getPromotion_Cus(cuscod, 'yearly') //โปรโมชั่นแบบใช้ตัวเลือก
            });

            chkcustomer();
        });
        expire(usrexpire)
        //function expire(usrexpire) {
        //    var expireval;
        //    expireval = usrexpire;
        //    var _typ = usertype;
        //    var x = expireval.replace("Passwords expire '", "");
        //    expireval = x.replace("' days", "");

        //    if (parseInt(expireval) <= 15) {
        //        $("#textAlertWarning").empty();
        //        if (_typ == "2") {
        //            $("#textAlertWarning").text("Password ของท่านอีก" + usrexpire + "วัน ใกล้หมดอายุ กรุณาเปลี่ยน Password  เข้าไปเปลี่ยน Password ได้ที่ App Citrix");
        //        } else if (_typ == "1") {
        //            $("#textAlertWarning").text("Password ของท่านอีก " + usrexpire + "วัน ใกล้หมดอายุ กรุณาเปลี่ยน Password ");
        //        }
        //        //$("#myModalWarning").modal();
        //        $('#myModal').modal('show');
        //    }
        //}

        function checkDateExpireCustomer(usrexpire) {
            if (parseInt(usrexpire) <= 15) {
                $("#textAlertWarningDateExpire").empty();
                $("#textAlertWarningDateExpire").html("Password ของท่านอีก " + usrexpire + " วัน ใกล้หมดอายุ <br> กรุณาเปลี่ยน Password โดยเข้าที่เมนู Change password");
                $("#myModalWarningDateExpire").modal();
            }
        }
        if (usertype == "6") {
            setTimeout(function () {
                checkDateExpireCustomer(usrexpire)
            }, 1000);
        }

        function commaSeparateNumber(val) {
            while (/(\d+)(\d{3})/.test(val.toString())) {
                val = val.toString().replace(/(\d+)(\d{3})/, '$1' + ',' + '$2');
            }
            return val;
        }
        function clearChartsamt() {
            var optionsProfileVisit = {
                annotations: {
                    position: 'back'
                },
                dataLabels: {
                    enabled: false
                },
                chart: {
                    type: 'bar',
                    height: 200,

                },

                fill: {
                    opacity: 1
                },
                plotOptions: {
                },


                series: [{
                    name: 'sales',
                    data: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]


                }],
                //colors: '#435ebe',
                colors: ['#424bf9', '#e70712', '#4bf942'],
                xaxis: {
                    categories: ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"],
                },
            }
            var chartProfileVisit = new ApexCharts(document.querySelector("#chart-profile-visit"), optionsProfileVisit);
            chartProfileVisit.render();

            window.dispatchEvent(new Event('resize'));


            $('#amtytd_aac').html('Amt YTD AAC: 0');
            $('#amtytd_tac').html('Amt YTD TAC: 0');
            $('#amtytd_all').html('Amt YTD ALL: 0');
            $('#amtmtd_aac').html('Amt MTD AAC: 0');//amtmtd_aac
            $('#amtmtd_tac').html('Amt MTD TAC: 0');
            $('#amtmtd_all').html('Amt MTD ALL: 0');
        }

        function clearChartsamt_child() {
            var optionsProfileVisit = {
                annotations: {
                    position: 'back'
                },
                dataLabels: {
                    enabled: false
                },
                chart: {
                    type: 'bar',
                    height: 200,

                },

                fill: {
                    opacity: 1
                },
                plotOptions: {
                },


                series: [{
                    name: 'sales',
                    data: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]


                }],
                //colors: '#435ebe',
                colors: ['#424bf9', '#e70712', '#4bf942'],
                xaxis: {
                    categories: ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"],
                },
            }
            var chartProfileVisit = new ApexCharts(document.querySelector("#chart-profile-visit-child"), optionsProfileVisit);
            chartProfileVisit.render();

            window.dispatchEvent(new Event('resize'));


            $('#amtytd_aac_cus').html('Amt YTD AAC: 0');
            $('#amtytd_tac_cus').html('Amt YTD TAC: 0');
            $('#amtytd_all_cus').html('Amt YTD ALL: 0');
            $('#amtmtd_aac_cus').html('Amt MTD AAC: 0');//amtmtd_aac
            $('#amtmtd_tac_cus').html('Amt MTD TAC: 0');
            $('#amtmtd_all_cus').html('Amt MTD ALL: 0');
        }

        function clearChartTop20() {
            var optionsProfileVisit = {
                annotations: {
                    position: 'back'
                },
                dataLabels: {
                    enabled: false
                },
                chart: {
                    type: 'bar',
                    height: 200,

                },

                fill: {
                    opacity: 1
                },
                plotOptions: {
                },


                series: [{
                    name: 'sales',
                    data: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]


                }],
                //colors: '#435ebe',
                colors: ['#424bf9', '#e70712', '#4bf942'],
                xaxis: {
                    categories: ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"],
                },
            }
            var chartProfileVisit = new ApexCharts(document.querySelector("#chart-profile-visit-child"), optionsProfileVisit);
            chartProfileVisit.render();

            window.dispatchEvent(new Event('resize'));


            $('#amtytd_aac_cus').html('Amt YTD AAC: 0');
            $('#amtytd_tac_cus').html('Amt YTD TAC: 0');
            $('#amtytd_all_cus').html('Amt YTD ALL: 0');
            $('#amtmtd_aac_cus').html('Amt MTD AAC: 0');//amtmtd_aac
            $('#amtmtd_tac_cus').html('Amt MTD TAC: 0');
            $('#amtmtd_all_cus').html('Amt MTD ALL: 0');
        }

        function getcuschamt(cusnc) {
            var current_status = $('.statusamt').text();
            if (current_status != "Untoggled") {
                $.ajax({
                    url: '@Url.Action("GetdataCusAmt", "DataCenter")',
                    data: {
                        strcustome: cusnc

                    },
                    type: "POST",
                    dataType: "JSON",
                    success: function (data) {
                        // console.log(data)

                        if (data.length > 0) {

                            var optionsProfileVisit = {
                                annotations: {
                                    position: 'back'
                                },
                                dataLabels: {
                                    enabled: false
                                },
                                chart: {
                                    type: 'bar',
                                    height: 200,


                                },
                                xaxis: {
                                    labels: {
                                        formatter: function (value) {
                                            return commaSeparateNumber(value);
                                        }
                                    },

                                },
                                yaxis: {
                                    labels: {
                                        formatter: function (value) {
                                            return commaSeparateNumber(value);
                                        }
                                    },
                                },
                                fill: {
                                    opacity: 1
                                },
                                plotOptions: {
                                },

                                series: [
                            {
                                name: 'AAC',
                                type: 'column',
                                data: [data[0].Jan, data[0].Feb, data[0].Mar, data[0].Apr, data[0].May, data[0].Jun, data[0].Jul, data[0].Aug, data[0].Sep, data[0].Oct, data[0].Nov, data[0].Dec]
                            },
                            {
                                name: 'TAC',
                                type: 'column',
                                data: [data[1].Jan, data[1].Feb, data[1].Mar, data[1].Apr, data[1].May, data[1].Jun, data[1].Jul, data[1].Aug, data[1].Sep, data[1].Oct, data[1].Nov, data[1].Dec]
                            },
                            {
                                name: 'ALL',
                                type: 'column',
                                data: [data[2].Jan, data[2].Feb, data[2].Mar, data[2].Apr, data[2].May, data[2].Jun, data[2].Jul, data[2].Aug, data[2].Sep, data[2].Oct, data[2].Nov, data[2].Dec]
                            }],
                                //series: [{
                                //    name: 'sales',
                                //    //data: [27, 9, 20, 30, 20, 10, 20, 30, 20, 10, 20, 30, 50]
                                //    data: [data[1].AmtYTD, data[1].Jan, data[1].Feb, data[1].Mar, data[1].Apr, data[1].May, data[1].Jun, data[1].Jul, data[1].Aug, data[1].Sep, data[1].Oct, data[1].Nov, data[1].Dec]

                                //}],
                                //colors: '#435ebe',
                                colors: ['#424bf9', '#e70712', '#4bf942'],
                                xaxis: {
                                    categories: ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"],
                                },
                            }
                            var chartProfileVisit = new ApexCharts(document.querySelector("#chart-profile-visit"), optionsProfileVisit);
                            chartProfileVisit.render();

                            window.dispatchEvent(new Event('resize'));
                            $('#amtytd_aac').html('Amt YTD AAC: ' + commaSeparateNumber(data[0].AmtYTD));
                            $('#amtytd_tac').html('Amt YTD TAC: ' + commaSeparateNumber(data[1].AmtYTD));
                            $('#amtytd_all').html('Amt YTD ALL: ' + commaSeparateNumber(data[2].AmtYTD));
                            $('#amtmtd_aac').html('Amt MTD AAC: ' + commaSeparateNumber(data[0].AmtMTD));//amtmtd_aac
                            $('#amtmtd_tac').html('Amt MTD TAC: ' + commaSeparateNumber(data[1].AmtMTD));
                            $('#amtmtd_all').html('Amt MTD ALL: ' + commaSeparateNumber(data[2].AmtMTD));

                            console.log(data[0].AmtMTD);
                            const dataP = {
                                labels: [
                                    'AAC',
                                    'TAC',

                                ],
                                datasets: [{
                                    label: 'ยอดซื้อรวมทั้งเดือน',
                                    data: [data[0].AmtYTD, data[1].AmtYTD],
                                    backgroundColor: [
                                        'rgb(54, 162, 235)',
                                        'rgb(255, 99, 132)',
                                    ],
                                    hoverOffset: 4
                                }]
                            };
                            const config = {
                                type: 'pie',
                                data: dataP,
                                //options: {
                                //    plugins: {
                                //        title: {
                                //            display: true,
                                //            text: 'ยอดซื้อรวมทั้งเดือน'
                                //        }
                                //    }
                                //}
                            };

                            var ctx = document.getElementById('myChart').getContext('2d');
                            var myChart = new Chart(ctx, config);

                        } else {
                            var optionsProfileVisit = {
                                annotations: {
                                    position: 'back'
                                },
                                dataLabels: {
                                    enabled: false
                                },
                                chart: {
                                    type: 'bar',
                                    height: 200,

                                },

                                fill: {
                                    opacity: 1
                                },
                                plotOptions: {
                                },


                                series: [{
                                    name: 'sales',
                                    data: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]


                                }],
                                //colors: '#435ebe',
                                colors: ['#424bf9', '#e70712', '#4bf942'],
                                xaxis: {
                                    categories: ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"],
                                },
                            }
                            var chartProfileVisit = new ApexCharts(document.querySelector("#chart-profile-visit"), optionsProfileVisit);
                            chartProfileVisit.render();

                            window.dispatchEvent(new Event('resize'));


                            $('#amtytd_aac').html('Amt YTD AAC: 0');
                            $('#amtytd_tac').html('Amt YTD TAC: 0');
                            $('#amtytd_all').html('Amt YTD ALL: 0');
                            $('#amtmtd_aac').html('Amt MTD AAC: 0');//amtmtd_aac
                            $('#amtmtd_tac').html('Amt MTD TAC: 0');
                            $('#amtmtd_all').html('Amt MTD ALL: 0');
                        }
                    }
                });
            }
        }
        function getcuschamt_child(cusnc) {

            //cusnc = '110K0140';
            var current_status = $('.statusamtchild').text();
            if (current_status != "Untoggled") {
                $.ajax({
                    url: '@Url.Action("GetdataCusAmtchild", "DataCenter")',
                    data: {
                        strcustome: cusnc

                    },
                    type: "POST",
                    dataType: "JSON",
                    success: function (data) {
                        //console.log(data)
                        if (data.length > 0) {

                            var optionsProfileVisit = {
                                annotations: {
                                    position: 'back'
                                },
                                dataLabels: {
                                    enabled: false
                                },
                                chart: {
                                    type: 'bar',
                                    height: 200,

                                },
                                xaxis: {
                                    labels: {
                                        formatter: function (value) {
                                            return commaSeparateNumber(value);
                                        }
                                    },

                                },
                                yaxis: {
                                    labels: {
                                        formatter: function (value) {
                                            return commaSeparateNumber(value);
                                        }
                                    },
                                },
                                fill: {
                                    opacity: 1
                                },
                                plotOptions: {
                                },

                                series: [
                            {
                                name: 'AAC',
                                type: 'column',
                                data: [data[0].Jan, data[0].Feb, data[0].Mar, data[0].Apr, data[0].May, data[0].Jun, data[0].Jul, data[0].Aug, data[0].Sep, data[0].Oct, data[0].Nov, data[0].Dec]
                            },
                            {
                                name: 'TAC',
                                type: 'column',
                                data: [data[1].Jan, data[1].Feb, data[1].Mar, data[1].Apr, data[1].May, data[1].Jun, data[1].Jul, data[1].Aug, data[1].Sep, data[1].Oct, data[1].Nov, data[1].Dec]
                            },
                            {
                                name: 'ALL',
                                type: 'column',
                                data: [data[2].Jan, data[2].Feb, data[2].Mar, data[2].Apr, data[2].May, data[2].Jun, data[2].Jul, data[2].Aug, data[2].Sep, data[2].Oct, data[2].Nov, data[2].Dec]
                            }],
                                //series: [{
                                //    name: 'sales',
                                //    //data: [27, 9, 20, 30, 20, 10, 20, 30, 20, 10, 20, 30, 50]
                                //    data: [data[1].AmtYTD, data[1].Jan, data[1].Feb, data[1].Mar, data[1].Apr, data[1].May, data[1].Jun, data[1].Jul, data[1].Aug, data[1].Sep, data[1].Oct, data[1].Nov, data[1].Dec]

                                //}],
                                //colors: '#435ebe',
                                colors: ['#424bf9', '#e70712', '#4bf942'],
                                xaxis: {
                                    categories: ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"],
                                },
                            }
                            var chartProfileVisit = new ApexCharts(document.querySelector("#chart-profile-visit-child"), optionsProfileVisit);
                            chartProfileVisit.render();

                            window.dispatchEvent(new Event('resize'));

                            $('#amtytd_aac_cus').html('Amt YTD AAC: ' + commaSeparateNumber(data[0].AmtYTD));
                            $('#amtytd_tac_cus').html('Amt YTD TAC: ' + commaSeparateNumber(data[1].AmtYTD));
                            $('#amtytd_all_cus').html('Amt YTD ALL: ' + commaSeparateNumber(data[2].AmtYTD));
                            $('#amtmtd_aac_cus').html('Amt MTD AAC: ' + commaSeparateNumber(data[0].AmtMTD));//amtmtd_aac
                            $('#amtmtd_tac_cus').html('Amt MTD TAC: ' + commaSeparateNumber(data[1].AmtMTD));
                            $('#amtmtd_all_cus').html('Amt MTD ALL: ' + commaSeparateNumber(data[2].AmtMTD));
                        } else {
                            var optionsProfileVisit = {
                                annotations: {
                                    position: 'back'
                                },
                                dataLabels: {
                                    enabled: false
                                },
                                chart: {
                                    type: 'bar',
                                    height: 200,

                                },

                                fill: {
                                    opacity: 1
                                },
                                plotOptions: {
                                },


                                series: [{
                                    name: 'sales',
                                    data: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]


                                }],
                                //colors: '#435ebe',
                                colors: ['#424bf9', '#e70712', '#4bf942'],
                                xaxis: {
                                    categories: ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"],
                                },
                            }
                            var chartProfileVisit = new ApexCharts(document.querySelector("#chart-profile-visit-child"), optionsProfileVisit);
                            chartProfileVisit.render();

                            window.dispatchEvent(new Event('resize'));


                            $('#amtytd_aac_cus').html('Amt YTD AAC: 0');
                            $('#amtytd_tac_cus').html('Amt YTD TAC: 0');
                            $('#amtytd_all_cus').html('Amt YTD ALL: 0');
                            $('#amtmtd_aac_cus').html('Amt MTD AAC: 0');//amtmtd_aac
                            $('#amtmtd_tac_cus').html('Amt MTD TAC: 0');
                            $('#amtmtd_all_cus').html('Amt MTD ALL: 0');
                        }
                    }
                });
            }
        }

        $("#btnnewitem").on("click", function () {
            var cuskey = $("#cushid").val();//checkcustomerบัญชีลูกค้า:
            var cuscod = cuskey;
            if (cuscod == "") {
                $("#textAlertWarning").empty();
                $("#textAlertWarning").text("กรุณาเลือกลูกค้าที่ต้องการ Shopping");
                $("#myModalWarning").modal(); return false;

            } else {
                getContinue_Newitwm();
                $("#ExtraLargeModalLabel").modal();
            }

        });
        $('#ExtraLargeModalLabel').on('hidden.bs.modal', function () {
            //window.alert('hidden event fired!');
            //$('#fixboxs').empty();
            //location.reload();
           // $('#fixboxs').remove();
        })







        $(document).on("click", "#_btnlinkdetail", function () {
            var cuscod = $("#cushid").val();//checkcustomerบัญชีลูกค้า:
            var _vcom = $(this).attr('com');
            var _vfd = $(this).attr('stock');
            var wi = window.open("../Productdetails/Index?prodenum=" + btoa(_vfd) + "/" + btoa(_vcom) + "/" + btoa(cuscod));
            wi.focus();
        });

        function openPeriod(PeriodName, id) {


            // $('.btnpromotion').addClass('removeselected');
            //
            //  $('#' + id + '').addClass('selected');
            //   $('#' + id + '').removeClass('removeselected');
            //background: blueviolet;

            var i;
            var x = document.getElementsByClassName("city");
            for (i = 0; i < x.length; i++) {
                x[i].style.display = "none";
            }
            document.getElementById(PeriodName).style.display = "block";
            var cusnc = $('#cussend').val();
            var period = PeriodName;
            //alert(period)
            getPromotion_Cus(cusnc, period);
        }
        //TOP20
        function getListTop20(cuscod) {
            var current_status = $('.statusTop20').text();
            var txtWarning = "";
            if (current_status != "Untoggled") {
                $.ajax({
                    url: '@Url.Action("GetdataCusAmtTop20", "DataCenter")',
                    data: {
                        cuscod: cuscod,
                    },
                    type: "POST",
                    dataType: "JSON",
                    success: function (data) {
                        console.log(data)
                        $('#tableListTop20 tbody:last-child').html("");
                        var SubmithtmlPages = "";
                        if (data.length > 0) {
                            for (var i = 0; i < data.length; i++) {
                                SubmithtmlPages += '<tr>';
                                SubmithtmlPages += '<td>' + data[i].Rowid + '</td>';
                                SubmithtmlPages += '<td align="center">' + data[i].Company + '</td>';
                                // SubmithtmlPages += '<td>' + data[i].Cuscod + '</td>';
                                SubmithtmlPages += '<td>' + data[i].Stkcod + '</td>';
                                SubmithtmlPages += '<td>' + data[i].Stkdes + '</td>';
                                SubmithtmlPages += '<td align="center">' + parseInt(data[i].Qty) + '</td>';
                                SubmithtmlPages += '<td>' + commaSeparateNumber(data[i].Amt) + '</td>';
                                SubmithtmlPages += '</tr>';
                            }
                        } else {
                            if (cuscod == "") {
                                txtWarning = "กรุณาเลือกร้านค้า";
                            } else {
                                txtWarning = "-ไม่พบข้อมูล-";
                            }
                            SubmithtmlPages += '<tr>';
                            SubmithtmlPages += '<td colspan="6" align="center">' + txtWarning + '</td>';
                            SubmithtmlPages += '</tr>';
                        }
                        $("#tableListTop20").append(SubmithtmlPages);
                    }
                });
            }
        }

        function getPromotion_Cus(cusnc, period) { //โปรโมชั่น ฟังก์ชั่น
            var current_status = $('.statuspromotion').text();
            var reward_color = "";
            console.log("Promotion Cus : " + cusnc);
                $.ajax({
                    url: '@Url.Action("GetdataPromotion_Cus", "DataCenter")',
                    data: {
                        strcustome: cusnc,
                        period: period
                    },
                    type: "POST",
                    dataType: "JSON",
                    success: function (data) {
                        //console.log(data)
                        $('#promotiontbyearly tbody:last-child').html("");
                        $('#promotiontbquater tbody:last-child').html("");
                        $('#promotiontbother tbody:last-child').html("");
                        var SubmithtmlPage = "";
                        if (data.length > 0) {
                            for (var i = 0; i < data.length; i++) {

                                SubmithtmlPage += '<tr>';
                                SubmithtmlPage += '<td>' + data[i].Promotion_Name + '</td>';
                                SubmithtmlPage += '<td>' + commaSeparateNumber(data[i].Condition) + '</td>';
                                //SubmithtmlPage += '<td>' + data[i].StartDate + '</td>';
                                SubmithtmlPage += '<td>' + data[i].EndDate + '</td>';
                                SubmithtmlPage += '<td>' + commaSeparateNumber(data[i].INVAMT) + '</td>';
                                SubmithtmlPage += '<td>' + commaSeparateNumber(data[i].RemainAmt) + '</td>';
                                if (data[i].Reward.toString().toLowerCase().includes("ticket")) {
                                    reward_color = "bg-warning bg-opacity-75";
                                }
                                else if (data[i].Reward.toString().includes("ตั๋ว")) {
                                    reward_color = "bg-warning bg-opacity-75 ";
                                }
                                else if (data[i].Reward.toString().includes("เช็ค")) {
                                    reward_color = "bg-success bg-opacity-75";
                                }
                                else {
                                    reward_color = "bg-info bg-opacity-75 ";
                                }

                                SubmithtmlPage += '<td> <span class="badge ' + reward_color + '">' + data[i].Reward + '</span> </td>';
                                SubmithtmlPage += '</tr>';
                            }
                            if (period == 'yearly') {
                                $("#promotiontbyearly").append(SubmithtmlPage);
                                $('#btn_yearly').css("background", "#ACE2E1");
                                $('#btn_quater').removeAttr('style');
                                $('#btn_other').removeAttr('style');

                            } else if (period == 'quater') {
                                $("#promotiontbquater").append(SubmithtmlPage);
                                $('#btn_yearly').removeAttr('style');
                                $('#btn_quater').css("background", "#ACE2E1");
                                $('#btn_other').removeAttr('style');
                            } else if (period == 'other') {
                                $("#promotiontbother").append(SubmithtmlPage);

                                $('#btn_yearly').removeAttr('style');
                                $('#btn_quater').removeAttr('style');
                                $('#btn_other').css("background", "#ACE2E1");
                            }
                        }
                    }
                });
        }
        function getWarrantyClaim_Cu(cusnc) {
            var current_status = $('.statuscliamoffon').text();
            if (current_status != "Untoggled") {
                $.ajax({
                    url: '@Url.Action("GetdataWarrantyClaim_Cus_count", "DataCenter")',
                    data: {
                        strcustome: cusnc

                    },
                    type: "POST",
                    dataType: "JSON",
                    success: function (data) {
                        //console.log(data)
                        $('#climtb tbody:last-child').html("");
                        var SubmithtmlPage = "";
                        if (data.length > 0) {
                            for (var i = 0; i < data.length; i++) {

                                SubmithtmlPage += '<tr>';
                                SubmithtmlPage += '<td id="_btnview" style="cursor: pointer; color: darkorchid; text-decoration: underline; width: 118px;left: 0px;"cussend=' + cusnc + ' tap=a>' + data[i].A + '</a></td>';
                                SubmithtmlPage += '<td id="_btnview" style="cursor: pointer; color: darkorchid; text-decoration: underline; width: 118px;left: 0px;"cussend=' + cusnc + ' tap=b>' + data[i].B + '</a></td>';
                                SubmithtmlPage += '<td id="_btnview" style="cursor: pointer; color: darkorchid; text-decoration: underline; width: 118px;left: 0px;"cussend=' + cusnc + ' tap=c>' + data[i].C + '</a></td>';
                                SubmithtmlPage += '</tr>';
                            }
                            $("#climtb").append(SubmithtmlPage);
                        }
                    }
                });
            }
        }
        $("table").on("click", "tr #_btnview", function () {
            var cussend = $(this).attr('cussend');
            var tap = $(this).attr('tap');
            // alert(tap + '////' + cussend)

            getWarrantyClaim_Cudetail(cussend, tap)
        });
        function getWarrantyClaim_Cudetail(cusnc, tap) {

            $.ajax({
                url: '@Url.Action("GetdataWarrantyClaim_Cus", "DataCenter")',
                data: {
                    strcustome: cusnc,
                    tap: tap
                },
                type: "POST",
                dataType: "JSON",
                success: function (data) {
                    //console.log(data)

                    $('#climtbdatail tbody:last-child').html("");
                    var SubmithtmlPage = "";
                    if (data.length > 0) {

                        for (var i = 0; i < data.length; i++) {

                            SubmithtmlPage += '<tr>';
                            SubmithtmlPage += '<td>' + data[i].CLM_NO_SUB + '</td>';
                            SubmithtmlPage += '<td>' + data[i].STKCOD + '/' + data[i].STKDES + '</td>';
                            SubmithtmlPage += '<td>' + data[i].Qty + '</td>';
                            SubmithtmlPage += '<td>' + data[i].REQ_DATE + '</td>';
                            SubmithtmlPage += '<td>' + data[i].ReceiveDate + '</td>';
                            SubmithtmlPage += '<td>' + data[i].Request + '</td>';
                            SubmithtmlPage += '<td>' + data[i].Status + '</td>';
                            SubmithtmlPage += '</tr>';
                        }
                        $("#climtbdatail").append(SubmithtmlPage);

                        $("#myModalclimtb").modal();
                    }
                }
            });
        }
        $('#chkSelect').change(function () {
            if (this.checked) {
                var cusnc = $('#nocusses').val();
                getbackord(cusnc)
                //var returnVal = confirm("Are you sure?");
                //$(this).prop("checked", returnVal);
            } else {
                var cusnc = $('#nocusses').val();
                getbackord(cusnc)
            }

        });
        function getbackord(cusnc) {
            var Stock_Flag = ""
            var isChecked = $('#chkSelect').is(':checked');
            if (isChecked == true) {
                Stock_Flag = "1";
            } else {
                Stock_Flag = "0";
            }

            var Show_Flag = "2";


            var Stock_Flag = Stock_Flag;
            var current_status = $('.statusbackord').text();
            if (current_status != "Untoggled") {
                $.ajax({
                    url: '@Url.Action("getbackorder", "BackOrderAll")',
                    data: {
                        CUSCOD: cusnc,
                        SLMID: '0',
                        stkcod: '',
                        Show_Flag: Show_Flag,
                        Stock_Flag: Stock_Flag,
                        //Stock_Flag: "0",
                        COM: "ALL",
                        DocumentNo: "",
                        UserType: '@Session["UserType"]'
                    },
                    type: "POST",
                    dataType: "JSON",
                    success: function (data) {
                        //console.log(data)

                        $('#backordtb tbody:last-child').html("");
                        if (data.length > 0) {
                            var SubmithtmlPage = "";

                            var SubmithtmlPage = "";
                            for (var i = 0; i < data.length; i++) {
                                // SubmithtmlPage += ' <table class="fancyTable" id="myTable05" cellpadding="0" cellspacing="0">';
                                SubmithtmlPage += '<tr data-index=' + data[i].SeqNum + data[i].SaleOrder_No + '>';
                                SubmithtmlPage += '<td>' + data[i].SaleOrder_No + '</td>';
                                SubmithtmlPage += '<td>' + data[i].STKCOD + '/' + data[i].STKDES + '</td>';
                                SubmithtmlPage += '<td class="orgbck">' + data[i].Qty + '</td>';
                                SubmithtmlPage += '<td>' + data[i].SaleOrder_Date + '</td>';
                                SubmithtmlPage += '<td>' + data[i].DLVDAT + '</td>';
                                SubmithtmlPage += '</tr >';

                            }
                            $("#backordtb").append(SubmithtmlPage);

                        } else {

                        }
                    }
                });
            }
        }
        function getCompanyInformation(cusnc) {

            $.ajax({
                url: '@Url.Action("GetdataCuslogincus", "DataCenter")',
                data: {
                    cusel: cusnc
                },
                type: "POST",
                dataType: "JSON",
                success: function (data) {
                    //console.log(data);

                    $("#selslm").append($("<option custyp=" + data[0].SLMCOD + ">").val(data[0].SLMCOD).text(data[0].SLMCOD + "|" + data[0].SLMNAM));

                    $("#selslm").prop("disabled", true);

                    $("#chart-Salesman").text("Salesman:" + data[0].SLMNAM);
                    $("#chart-Salesmanphone").text("เบอร์ติดต่อ:" + data[0].SLMPhone)
                    $("#chart-SalesCo").text("SalesCo:" + data[0].SalesCo);
                    $("#chart-SalesCophone").text("เบอร์ติดต่อ:" + data[0].SalesCoPhone);
                    //datacus();  ///auto get customer to option select customer
                }
            });
        }

        function getCompanyInformationbysalman(slm) {

            $.ajax({
                url: '@Url.Action("GetdataCompanyInformation", "DataCenter")',
                data: {
                    Slm: slm
                },
                type: "POST",
                dataType: "JSON",
                success: function (data) {
                    //console.log(data);

                    //  $("#selslm").append($("<option custyp=" + data[0].SLMCOD + ">").val(data[0].SLMCOD).text(data[0].SLMCOD + "|" + data[0].SLMNAM));

                    // $("#selslm").prop("disabled", true);

                    $("#chart-Salesman").text("Salesman:" + data[0].SLMNAM);
                    $("#chart-Salesmanphone").text("เบอร์ติดต่อ:" + data[0].Phone);
                    $("#chart-SalesCo").text("SalesCo:" + data[0].SalesCo);
                    $("#chart-SalesCophone").text("เบอร์ติดต่อ:" + data[0].SalesCoPhone);
                    //datacus();  ///auto get customer to option select customer
                }
            });
        }

        function getCompanyInfor() {

            $.ajax({
                url: '@Url.Action("GetdataCompanyInfo", "DataCenter")',
                data: {

                },
                type: "POST",
                dataType: "JSON",
                success: function (data) {
                    //console.log(data);

                    //  $("#selslm").append($("<option custyp=" + data[0].SLMCOD + ">").val(data[0].SLMCOD).text(data[0].SLMCOD + "|" + data[0].SLMNAM));

                    // $("#selslm").prop("disabled", true);

                    $("#aaccomname").text(data[0].Name);
                    // $("#aacaddress").text(data[0].Address1 + ' ' + data[0].Address2);
                    $("#aacphone").text("Tel: " + data[0].Phone);
                    $("#aacfax").text('Fax:' + data[0].Fax);
                    $("#aactax").text("Tax: " + data[0].Tax);
                    $("#aacBank1").text("Bank1: " + data[0].Bank1);
                    $("#aacBank2").text("Bank2: " + data[0].Bank2);

                    $("#taccomname").text(data[1].Name);
                    $("#tacaddress").text(data[1].Address1 + ' ' + data[1].Address2);
                    $("#tacphone").text("Tel: " + data[1].Phone);
                    $("#tacfax").text('Fax:' + data[1].Fax);
                    $("#tactax").text("Tax: " + data[1].Tax);
                    $("#tacBank1").text("Bank1: " + data[1].Bank1);
                    $("#tacBank2").text("Bank2: " + data[1].Bank2);
                    //datacus();  ///auto get customer to option select customer
                }
            });
        }

        function getcus() {

            var SLM = $("#selslm").val();
            var SLMt = $("#selslm option:selected").text();
            $.ajax({
                url: '@Url.Action("Getdatabyslm", "DataCenter")',
                data: {
                    SLXX: SLM,
                    SLMNAME: SLMt
                },
                type: "POST",
                dataType: "JSON",
                success: function (data) {
                    //console.log(data);
                    var select = $("#selcus");
                    select.children().remove();
                    // select.append($("<option>").val("ALL").text("ลูกค้าทั้งหมดของ " + SLMt));
                    select.append($("<option>").val("ALL").text("ลูกค้าทั้งหมด"));
                    $.each(data, function (key, value) {

                        select.append('<option value=' + value.CUSCOD + '>' + value.CUSCOD + '|' + value.CUSNAM + "----ที่อยู่ " + value.ADDR_01 + " " + value.PRO + '</option>');
                    });
                    $('.selectpicker').selectpicker('refresh');
                    $(".caret").css("display", "none");

                }
            });
        }
        function countorder(cus, Slm) {
            // var SLM = $("#Slm").val()

            $.ajax({
                url: '@Url.Action("GetdateContorder", "DataCenter")',
                data: {
                    cus: cus,
                    Slm: Slm,
                    Usertype: usertype,
                    UserIn: userid
                },
                type: "POST",
                dataType: "JSON",
                success: function (data) {
                    // //console.log(data);
                    //$('#countsku').text(data.Getdata[0].val.Countrow);
                    //$('#rd').text(data.Getdata[1].val.Countrow);
                    $('#countsku').text(data.Getdata[0].val.SumQty);
                    $('#rd').text(data.Getdata[1].val.SumQty);

                }
            });
        }

        $("#myInput").on("keyup", function () {

            var value = $(this).val().toLowerCase();
            $(".dropdown-menu li").filter(function () {
                $(this).toggle($(this).text().toLowerCase().indexOf(value) > -1)
            });
        });
        // $('#selcus').selectpicker();
        $(".dropdown-menu").on("click", ".searchterm", function (event) {
            var _val = $(this).attr('data-input');
            //alert(_val)
            $('#selcus').val(_val);
            Cusdetail()
        });
        //$('#textfree').click(function () {
        //    $("#selslm").val("ALL")
        //});
        // createOptions(30);

        $("#btnshsche").on("click", function () {
            if (usertype != "1") {
                //getslmandcus()
            } else {
                // $("#selslm").val("ALL");
            }
            $("#textfree").val("");
            $("#smallModalselcus").modal('show');
            // myFunction()
        });
        function myFunction() {
            var x = document.getElementById("blcslm");
            if (x.style.display === "none") {
                x.style.display = "block";
                $("#selslm").val("ALL");

            } else {
                x.style.display = "none";
                $("#selcus").prop("disabled", false);
            }
        }

        $('#selslm').change(function () {
            var SLM = $(this).val()
            var SLMt = $("#selslm option:selected").text();
            var cuskey = "";
            cuskey = $("#nocusses").val();
            var cusel = $("#cushid").val();
            if (cuskey == "") {
                cuskey = cusel;
            }
            if (SLM != "ALL") {
                countorder(cuskey, SLM)
            } else {
                window.location.replace("../SeleScrCustomer/dashboard");
            }
            getCompanyInformationbysalman(SLM);//Company Information
            //if (SLMt == "ALL") {

            //    $("#textfree").css("display", "block");
            //    $("#blcslm").css("display", "none");

            //} else {
            //    $("#textfree").css("display", "none");
            //    $("#blcslm").css("display", "block");
            //}
            $("#cus").text("");
            $("#addcus").text("");
            $("#crlicusaac").text("");
            $("#crlicustac").text("");
            $("#crbarcusaac").text("");
            $("#crbarcustac").text("");
            $("#crlicusaacday").text("");
            $("#crlicustacday").text("");
            $("#crlicusrating").text("");

            $("#cushid").val("");
            $("#nocusses").val("");
            $("#cussend").val("");//checkcustomerบัญชีลูกค้า:
            $.ajax({
                url: '@Url.Action("Getdatabyslm", "DataCenter")',
                data: {
                    SLXX: SLM,
                    SLMNAME: SLMt
                },
                type: "POST",
                dataType: "JSON",
                success: function (data) {
                    //console.log(data);
                    var select = $("#selcus");
                    select.children().remove();
                    // select.append($("<option>").val("ALL").text("ลูกค้าทั้งหมดของ "+ SLMt));
                    select.append($("<option>").val("ALL").text("ลูกค้าทั้งหมดของ"));
                    $.each(data, function (key, value) {

                        select.append('<option value=' + value.CUSCOD + '>' + value.CUSCOD + '|' + value.CUSNAM + "----ที่อยู่ " + value.ADDR_01 + " " + value.PRO + '</option>');
                    });
                    $('.selectpicker').selectpicker('refresh');
                    $(".caret").css("display", "none");
                }
            });

        });

        function datacus(slmco) {
            // var SLM = $('#selslm').val();

            var SLM = slmco;
            var SLMt = $("#selslm option:selected").text();

            $("#selslm").val(SLM);
            $.ajax({
                url: '@Url.Action("Getdatabyslm", "DataCenter")',
                data: {
                    SLXX: SLM,
                    SLMNAME: SLMt
                },
                type: "POST",
                dataType: "JSON",
                success: function (data) {
                    //console.log(data);
                    var select = $("#selcus");
                    select.children().remove();
                    //select.append($("<option>").val("ALL").text("ลูกค้าทั้งหมดของ " + SLMt));
                    select.append($("<option>").val("ALL").text("ลูกค้าทั้งหมด"));
                    $.each(data, function (key, value) {
                        select.append('<option value=' + value.CUSCOD + '>' + value.CUSCOD + '|' + value.CUSNAM + "----ที่อยู่ " + value.ADDR_01 + " " + value.PRO + '</option>');
                        //select.append('<option value=' + value.CUSCOD + '>' + value.CUSCOD + '|' + value.CUSNAM + '</option>');
                    });
                    $('.selectpicker').selectpicker('refresh');
                    $(".caret").css("display", "none");
                }
            });

        }

        function Cusdetail() {
            var cusel = $("#selcus").val();

            if (cusel == "0") {

                $("#textAlertWarning").empty();
                $("#textAlertWarning").text("กรุณาเลือกลูกค้าที่ต้องการ Shopping");
                $("#myModalWarning").modal();
                return false;
            } else {

                // $.session.set("myVarcus", cusel);
                $.ajax({
                    url: '@Url.Action("GetdatabyCus", "DataCenter")',
                    data: {
                        cusel: cusel
                    },
                    type: "POST",
                    dataType: "JSON",
                    success: function (data) {

                        //console.log(data);
                        $("#addcus").text(data[0].ADDR_01 + (data[0].ADDR_02));
                        if (usertype == "6") {
                            if (usrclmstaff == "1") {

                                $("#crlicusaac").text("xxxx");
                                $("#crlicustac").text("xxxx");
                                $("#crbarcusaac").text("xxxx");
                                $("#crbarcustac").text("xxxx");
                                $("#crlicusaacday").text("xxxx");
                                $("#crlicustacday").text("xxxx");
                                $("#crlicusrating").text("xxxx");
                            } else {
                                $("#crlicusaac").text(commaSeparateNumber(data[0].AACCrlimit));
                                $("#crlicustac").text(commaSeparateNumber(data[0].TACCrlimit));
                                $("#crbarcusaac").text(commaSeparateNumber(data[0].AACBalance));
                                $("#crbarcustac").text(commaSeparateNumber(data[0].TACBalance));
                                $("#crlicusaacday").text(data[0].AACPAYTRM);
                                $("#crlicustacday").text(data[0].TACPAYTRM);
                                $("#divrating").css("display", "");
                                $("#crlicusrating").text(data[0].RATING);
                            }
                        } else {
                            $("#crlicusaac").text(commaSeparateNumber(data[0].AACCrlimit));
                            $("#crlicustac").text(commaSeparateNumber(data[0].TACCrlimit));
                            $("#crbarcusaac").text(commaSeparateNumber(data[0].AACBalance));
                            $("#crbarcustac").text(commaSeparateNumber(data[0].TACBalance));
                            $("#crlicusaacday").text(data[0].AACPAYTRM);
                            $("#crlicustacday").text(data[0].TACPAYTRM);
                            $("#divrating").css("display", "");
                            $("#crlicusrating").text(data[0].RATING);
                        }
                        $("#cushid").val(data[0].CUSCOD);
                        $("#selslm").val(data[0].SLMCOD);
                        $("#cussend").val(data[0].CUSCOD);//checkcustomerบัญชีลูกค้า:

                        $('#dnow').html("คำนวณวงเงิน ณ วันที่:" + d + "/" + m + "/" + y);

                    }
                });

            }
        }
        $('.selectpicker').selectpicker({
            noneResultsText: 'Not found'

        });

        $("#textfree").autocomplete({
            selectFirst: true,
            autoFocus: true,
            source: function (request, response) {
                // var param = { Name: $('input[type="search"]').val(), Slm: $('#selslm').val() };
                var slmcus = "";
                if ($('#selslm').val() == null) {
                    slmcus = "ALL";
                } else {
                    slmcus = $('#selslm').val();
                }
                var param = { Name: $("#textfree").val(), Slm: slmcus };
                $.ajax({
                    url: '@Url.Action("GetdateCusCode", "DataCenter")',
                    data: JSON.stringify(param),
                    dataType: "json",
                    type: "POST",
                    contentType: "application/json; charset=utf-8",
                    dataFilter: function (data) { return data; },
                    success: function (data) {

                        response($.map(data.slice(0, 50), function (item) {
                            return {
                                value: item
                            }
                        }))

                    },
                    error: function (XMLhttpsRequest, textStatus, errorThrown) {
                        alert(textStatus);
                    }
                });
            },
            select: function (event, ui) {
                //console.log(ui.item.value);
                var cusname
                var Code = ui.item.value;
                var split_StockCode = Code.split('|');

                var item = "";
                if (split_StockCode[0] != "") {
                    item = split_StockCode[0].trim();
                    cusname = split_StockCode[1].trim();
                }
                $("#smallModalselcus").modal('hide');

                var retval = checkcustomerinactive(item)

                if (retval[0] == "1") {
                    showalr(retval[1])
                    return false;
                } else {
                    countorder(item, $('#selslm').val());
                    datacus($('#selslm').val());
                    getCompanyInformationbysalman($('#selslm').val());//Company Information
                }
                //getcuschamt(item)//ยอดซื้อรวม
                //getcuschamt_child(item) //ยอดซื้อตามร้านค้า
                //getPromotion_Cus(item, 'yearly')//โปรโมชั่น
                //getWarrantyClaim_Cu(item) //WarrantyClaim
                //getbackord(item)//backorder
            },

            minLength: 2//minLength as 2, it means when ever user enter 2 character in TextBox the AutoComplete method will fire and get its source data.
        });
        function showalr(cusname) {
            $("#textAlertWarning").empty();
            $("#textAlertWarning").text("ลูกค้าร้าน " + cusname + "ไม่สามารถทำรายการสั่งซื้อสินค้าได้ กรุณาติดต่อแผนก Credit Control หรือ Sales Admin");
            $("#myModalWarning").modal();
        }
        function checkcustomerinactive(cuscod) {
            var SLMt = $("#selslm option:selected").text();
            var typin;
            var retval = [];
            $.ajax({
                url: '@Url.Action("GetdatabyCus", "DataCenter")',
                data: {
                    cusel: cuscod
                },
                type: "POST",
                dataType: "JSON",
                async: false, //IGNORED!!
                success: function (data) {
                    // //console.log(data);
                    typin = data[0].INACTIVE;
                    block = data[0].BLOCKED;
                    //alert(data[0].SLMCOD)
                    $("#selslm").val(data[0].SLMCOD);
                    if (usertype == "6") {


                    } else {
                        $.ajax({
                            url: '@Url.Action("Getdatabyslm", "DataCenter")',
                            data: {
                                SLXX: data[0].SLMCOD,
                                SLMNAME: ""
                            },
                            type: "POST",
                            dataType: "JSON",
                            success: function (data) {
                                //console.log(data);
                                var select = $("#selcus");
                                select.children().remove();
                                select.append($("<option>").val("ALL").text("ลูกค้าทั้งหมดของ " + SLMt));
                                $.each(data, function (key, value) {
                                    select.append('<option value=' + value.CUSCOD + '>' + value.CUSCOD + '|' + value.CUSNAM + "----ที่อยู่ " + value.ADDR_01 + " " + value.PRO + '</option>');
                                    //select.append('<option value=' + value.CUSCOD + '>' + value.CUSCOD + '|' + value.CUSNAM + '</option>');
                                });
                                $('#selcus').val(data[0].CUSCOD);
                                $('.selectpicker').selectpicker('refresh');
                                $(".caret").css("display", "none");
                            }
                        });
                    }
                    if (typin == "Y") {
                        if (block == "0") {
                            //$("#textAlertWarning").empty();
                            //$("#textAlertWarning").text("ลูกค้าร้าน " + data[0].CUSNAM + "ไม่สามารถทำรายการสั่งซื้อสินค้าได้ กรุณาติดต่อแผนก Credit Control หรือ Sales Admin");
                            //$("#myModalWarning").modal();
                            $("#cus").text(data[0].CUSNAM + " (" + data[0].CUSCOD + ") ไม่สามารถทำรายการสั่งซื้อสินค้าได้ กรุณาติดต่อแผนก Credit Control หรือ Sales Admin");
                            $('#cus').attr('title', data[0].Hierarchy2_Channel);

                            $("#addcus").text("");
                            $("#crlicusaac").text("");
                            $("#crlicustac").text("");
                            $("#crbarcusaac").text("");
                            $("#crbarcustac").text("");
                            $("#crlicusaacday").text("");
                            $("#crlicustacday").text("");
                            $("#crlicusrating").text("");

                            $("#selslm").val(data[0].SLMCOD);
                            //$("#selslm").val("");
                            $("#cushid").val(data[0].CUSCOD);
                            $("#cussend").val(data[0].CUSCOD);//checkcustomerบัญชีลูกค้า:
                            $("#nocusses").val(data[0].CUSCOD);//master key customer


                            return retval = ["1", data[0].CUSNAM];
                        } else {
                            //alert("yy")
                            //$("#textAlertWarning").empty();
                            //$("#textAlertWarning").text("ลูกค้าร้าน " + data[0].CUSNAM + "ไม่สามารถทำรายการสั่งซื้อสินค้าได้ กรุณาติดต่อแผนก Credit Control หรือ Sales Admin");
                            //$("#myModalWarning").modal();
                            $("#cus").text(data[0].CUSNAM + " (" + data[0].CUSCOD + ") ไม่สามารถทำรายการสั่งซื้อสินค้าได้ กรุณาติดต่อแผนก Credit Control หรือ Sales Admin");
                            $('#cus').attr('title', data[0].Hierarchy2_Channel);
                            $("#addcus").text(data[0].ADDR_01 + (data[0].ADDR_02));

                            if (usertype == "6") {
                                if (usrclmstaff == "1") {
                                    $("#crlicusaac").text("xxxx");
                                    $("#crlicustac").text("xxxx");
                                    $("#crlicusaac").text("xxxx");
                                    $("#crlicustac").text("xxxx");
                                    $("#crbarcusaac").text("xxxx");
                                    $("#crbarcustac").text("xxxx");
                                    $("#crlicusaacday").text("xxxx");
                                    $("#crlicustacday").text("xxxx");
                                    $("#crlicusrating").text("xxxx");

                                } else {
                                    $("#crlicusaac").text(commaSeparateNumber(data[0].AACCrlimit));
                                    $("#crlicustac").text(commaSeparateNumber(data[0].TACCrlimit));
                                    $("#crbarcusaac").text(commaSeparateNumber(data[0].AACBalance));
                                    $("#crbarcustac").text(commaSeparateNumber(data[0].TACBalance));
                                    $("#crlicusaacday").text(data[0].AACPAYTRM);
                                    $("#crlicustacday").text(data[0].TACPAYTRM);
                                    $("#divrating").css("display", "");
                                    $("#crlicusrating").text(data[0].RATING);
                                }
                            } else {
                                $("#crlicusaac").text(commaSeparateNumber(data[0].AACCrlimit));
                                $("#crlicustac").text(commaSeparateNumber(data[0].TACCrlimit));
                                $("#crbarcusaac").text(commaSeparateNumber(data[0].AACBalance));
                                $("#crbarcustac").text(commaSeparateNumber(data[0].TACBalance));
                                $("#crlicusaacday").text(data[0].AACPAYTRM);
                                $("#crlicustacday").text(data[0].TACPAYTRM);
                                $("#divrating").css("display", "");
                                $("#crlicusrating").text(data[0].RATING);
                            }


                            //$("#crlicusaac").text(commaSeparateNumber(data[0].AACCrlimit));
                            //$("#crlicustac").text(commaSeparateNumber(data[0].TACCrlimit));
                            //$("#crbarcusaac").text(commaSeparateNumber(data[0].AACBalance));
                            //$("#crbarcustac").text(commaSeparateNumber(data[0].TACBalance));
                            //$("#crlicusaacday").text(data[0].AACPAYTRM);
                            //$("#crlicustacday").text(data[0].TACPAYTRM);

                            $("#selslm").val(data[0].SLMCOD);

                            $("#cushid").val(data[0].CUSCOD);
                            $("#cussend").val(data[0].CUSCOD);//checkcustomerบัญชีลูกค้า:
                            $("#nocusses").val(data[0].CUSCOD);//master key customer
                            $('#dnow').html("คำนวณวงเงิน ณ วันที่:" + d + "/" + m + "/" + y);
                            return retval = ["1", data[0].CUSNAM];
                        }

                    } else {
                        //alert("zz")
                        //$("#cus").text("Custome Code:" + data[0].CUSCOD + "  Customer Name" + data[0].CUSNAM);
                        if (block == "1") {
                            //$("#textAlertWarning").empty();
                            //$("#textAlertWarning").text("ลูกค้าร้าน " + data[0].CUSNAM + "ไม่สามารถทำรายการสั่งซื้อสินค้าได้ กรุณาติดต่อแผนก Credit Control หรือ Sales Admin");
                            //$("#myModalWarning").modal();
                            $("#cus").text(data[0].CUSNAM + " (" + data[0].CUSCOD + ") ไม่สามารถทำรายการสั่งซื้อสินค้าได้ กรุณาติดต่อแผนก Credit Control หรือ Sales Admin");
                            $('#cus').attr('title', data[0].Hierarchy2_Channel);
                            $("#addcus").text(data[0].ADDR_01 + (data[0].ADDR_02));
                            if (usertype == "6") {
                                if (usrclmstaff == "1") {
                                    $("#crlicusaac").text("xxxx");
                                    $("#crlicustac").text("xxxx");
                                    $("#crlicusaac").text("xxxx");
                                    $("#crlicustac").text("xxxx");
                                    $("#crbarcusaac").text("xxxx");
                                    $("#crbarcustac").text("xxxx");
                                    $("#crlicusaacday").text("xxxx");
                                    $("#crlicustacday").text("xxxx");
                                    $("#crlicusrating").text("xxxx");

                                } else {
                                    $("#crlicusaac").text(commaSeparateNumber(data[0].AACCrlimit));
                                    $("#crlicustac").text(commaSeparateNumber(data[0].TACCrlimit));
                                    $("#crbarcusaac").text(commaSeparateNumber(data[0].AACBalance));
                                    $("#crbarcustac").text(commaSeparateNumber(data[0].TACBalance));
                                    $("#crlicusaacday").text(data[0].AACPAYTRM);
                                    $("#crlicustacday").text(data[0].TACPAYTRM);
                                    $("#divrating").css("display", "");
                                    $("#crlicusrating").text(data[0].RATING);
                                }
                            } else {
                                $("#crlicusaac").text(commaSeparateNumber(data[0].AACCrlimit));
                                $("#crlicustac").text(commaSeparateNumber(data[0].TACCrlimit));
                                $("#crbarcusaac").text(commaSeparateNumber(data[0].AACBalance));
                                $("#crbarcustac").text(commaSeparateNumber(data[0].TACBalance));
                                $("#crlicusaacday").text(data[0].AACPAYTRM);
                                $("#crlicustacday").text(data[0].TACPAYTRM);
                                $("#divrating").css("display", "");
                                $("#crlicusrating").text(data[0].RATING);
                            }

                            //$("#crlicusaac").text(commaSeparateNumber(data[0].AACCrlimit));
                            //$("#crlicustac").text(commaSeparateNumber(data[0].TACCrlimit));
                            //$("#crbarcusaac").text(commaSeparateNumber(data[0].AACBalance));
                            //$("#crbarcustac").text(commaSeparateNumber(data[0].TACBalance));
                            //$("#crlicusaacday").text(data[0].AACPAYTRM);
                            //$("#crlicustacday").text(data[0].TACPAYTRM);

                            $("#selslm").val(data[0].SLMCOD);

                            $("#cushid").val(data[0].CUSCOD);
                            $("#cussend").val(data[0].CUSCOD);//checkcustomerบัญชีลูกค้า:
                            $("#nocusses").val(data[0].CUSCOD);//master key customer
                            $('#dnow').html("คำนวณวงเงิน ณ วันที่:" + d + "/" + m + "/" + y);
                            return retval = ["1", data[0].CUSNAM];
                        }
                        else {
                            //alert("aa")
                            $("#cus").text(data[0].CUSNAM + " (" + data[0].CUSCOD + ")");
                            $('#cus').attr('title', data[0].Hierarchy2_Channel);
                            $("#addcus").text(data[0].ADDR_01 + (data[0].ADDR_02));
                            if (usertype == "6") {
                                if (usrclmstaff == "1") {
                                    $("#crlicusaac").text("xxxx");
                                    $("#crlicustac").text("xxxx");
                                    $("#crlicusaac").text("xxxx");
                                    $("#crlicustac").text("xxxx");
                                    $("#crbarcusaac").text("xxxx");
                                    $("#crbarcustac").text("xxxx");
                                    $("#crlicusaacday").text("xxxx");
                                    $("#crlicustacday").text("xxxx");
                                    $("#crlicusrating").text("xxxx");

                                } else {
                                    $("#crlicusaac").text(commaSeparateNumber(data[0].AACCrlimit));
                                    $("#crlicustac").text(commaSeparateNumber(data[0].TACCrlimit));
                                    $("#crbarcusaac").text(commaSeparateNumber(data[0].AACBalance));
                                    $("#crbarcustac").text(commaSeparateNumber(data[0].TACBalance));
                                    $("#crlicusaacday").text(data[0].AACPAYTRM);
                                    $("#crlicustacday").text(data[0].TACPAYTRM);
                                    $("#divrating").css("display", "");
                                    $("#crlicusrating").text(data[0].RATING);
                                }
                            } else {
                                $("#crlicusaac").text(commaSeparateNumber(data[0].AACCrlimit));
                                $("#crlicustac").text(commaSeparateNumber(data[0].TACCrlimit));
                                $("#crbarcusaac").text(commaSeparateNumber(data[0].AACBalance));
                                $("#crbarcustac").text(commaSeparateNumber(data[0].TACBalance));
                                $("#crlicusaacday").text(data[0].AACPAYTRM);
                                $("#crlicustacday").text(data[0].TACPAYTRM);
                                $("#divrating").css("display", "");
                                $("#crlicusrating").text(data[0].RATING);
                            }
                            //$("#crlicusaac").text(commaSeparateNumber(data[0].AACCrlimit));
                            //$("#crlicustac").text(commaSeparateNumber(data[0].TACCrlimit));
                            //$("#crbarcusaac").text(commaSeparateNumber(data[0].AACBalance));
                            //$("#crbarcustac").text(commaSeparateNumber(data[0].TACBalance));
                            //$("#crlicusaacday").text(data[0].AACPAYTRM);
                            //$("#crlicustacday").text(data[0].TACPAYTRM);

                            $("#cushid").val(data[0].CUSCOD);
                            $("#selslm").val(data[0].SLMCOD);

                            $("#cussend").val(data[0].CUSCOD);//checkcustomerบัญชีลูกค้า:
                            $("#nocusses").val(data[0].CUSCOD);//master key customer
                            getCreditcuskey(cuscod)
                            $('#dnow').html("คำนวณวงเงิน ณ วันที่:" + d + "/" + m + "/" + y);
                            return retval = ["2", data[0].CUSNAM];
                        }
                    }

                },
                async: false

            });
            return retval;
        }
        function getCreditcuskey(cusel) {
            $.ajax({
                url: '@Url.Action("GetdCustomerCredit", "DataCenter")',
                data: {
                    cusel: cusel
                },
                type: "POST",
                dataType: "JSON",
                success: function (data) {
                    //console.log(data);
                    //APS//
                    if (usertype == "6") {
                        if (usrclmstaff == "1") {
                            $("#crlicusaac").text("xxxx");
                            $("#crlicustac").text("xxxx");

                        } else {
                            $("#crlicusaac").text(commaSeparateNumber(data[0].AACCrlimit));
                            $("#crlicustac").text(commaSeparateNumber(data[0].TACCrlimit));;
                        }
                    } else {
                        $("#crlicusaac").text(commaSeparateNumber(data[0].AACCrlimit));
                        $("#crlicustac").text(commaSeparateNumber(data[0].TACCrlimit));
                    }
                   // $("#crlicusaac").text(commaSeparateNumber(data[0].AACCrlimit));
                   // $("#crlicustac").text(commaSeparateNumber(data[0].TACCrlimit));


                }
            });
        }
        function cleardataselect() {
            $("#addcus").text("");
            $("#crlicusaac").text("");
            $("#crlicustac").text("");
            $("#crbarcusaac").text("");
            $("#crbarcustac").text("");
            $("#crlicusaacday").text("");
            $("#crlicustacday").text("");
            $("#crlicusrating").text("");

            //$("#selslm").val();
            $("#cus").text("");
            $("#cushid").val("");
            $("#cussend").val("");//checkcustomerบัญชีลูกค้า:
            $("#nocusses").val("");//master key customer
        }

        $('#selcus').change(function () {
            var cusel = $("#selcus").val();
            var Slm = $("#selslm").val();
            // var cusold = $("#cus").html();
            //var cusold = $("#cushid").val();
            // countorder(cusel, Slm)

            var selcusoption = $("#selcus option:selected").text();
            //var cusold = cuscod;
            var cusold = $("#nocusses").val();

            if (cusel == "0") {
                $("#textAlertWarning").empty();
                $("#textAlertWarning").text("กรุณาเลือกลูกค้าที่ต้องการ Shopping");
                $("#myModalWarning").modal();
                return false;
            } else if (cusel != "ALL") {
                countorder(cusel, Slm)
                var typin;
                var block;
                $.ajax({
                    url: '@Url.Action("GetdatabyCus", "DataCenter")',
                    data: {
                        cusel: cusel
                    },
                    type: "POST",
                    dataType: "JSON",
                    success: function (data) {
                        //console.log(data);
                        typin = data[0].INACTIVE;
                        block = data[0].BLOCKED;
                        //alert(block)
                        if (typin == "Y") {
                            if (block == "0") {
                                $("#textAlertWarning").empty();
                                $("#textAlertWarning").text("ลูกค้าร้าน " + data[0].CUSNAM + "ไม่สามารถทำรายการสั่งซื้อสินค้าได้ กรุณาติดต่อแผนก Credit Control หรือ Sales Admin");
                                $("#myModalWarning").modal();
                                $("#cus").text(data[0].CUSNAM + " (" + data[0].CUSCOD + ") ไม่สามารถทำรายการสั่งซื้อสินค้าได้ กรุณาติดต่อแผนก Credit Control หรือ Sales Admin");
                                $('#cus').attr('title', data[0].Hierarchy2_Channel);
                                $("#addcus").text("");
                                $("#crlicusaac").text("");
                                $("#crlicustac").text("");
                                $("#crbarcusaac").text("");
                                $("#crbarcustac").text("");
                                $("#crlicusaacday").text("");
                                $("#crlicustacday").text("");
                                $("#crlicusrating").text("");

                                $("#selslm").val(data[0].SLMCOD);

                                $("#cushid").val(data[0].CUSCOD);
                                $("#cussend").val(data[0].CUSCOD);//checkcustomerบัญชีลูกค้า:
                                $("#nocusses").val(data[0].CUSCOD);//master key customer
                                return false;
                            } else {
                                $("#textAlertWarning").empty();
                                $("#textAlertWarning").text("ลูกค้าร้าน " + data[0].CUSNAM + "ไม่สามารถทำรายการสั่งซื้อสินค้าได้ กรุณาติดต่อแผนก Credit Control หรือ Sales Admin");
                                $("#myModalWarning").modal();
                                $("#cus").text(data[0].CUSNAM + " (" + data[0].CUSCOD + ") ไม่สามารถทำรายการสั่งซื้อสินค้าได้ กรุณาติดต่อแผนก Credit Control หรือ Sales Admin");
                                $('#cus').attr('title', data[0].Hierarchy2_Channel);
                                $("#addcus").text("");
                                $("#crlicusaac").text("");
                                $("#crlicustac").text("");
                                $("#crbarcusaac").text("");
                                $("#crbarcustac").text("");
                                $("#crlicusaacday").text("");
                                $("#crlicustacday").text("");
                                $("#crlicusrating").text("");

                                $("#selslm").val(data[0].SLMCOD);

                                $("#cushid").val(data[0].CUSCOD);
                                $("#cussend").val(data[0].CUSCOD);//checkcustomerบัญชีลูกค้า:
                                $("#nocusses").val(data[0].CUSCOD);//master key customer
                                return false;
                            }

                        } else {
                            //$("#cus").text("Custome Code:" + data[0].CUSCOD + "  Customer Name" + data[0].CUSNAM);
                            if (block == "1") {
                                $("#textAlertWarning").empty();
                                $("#textAlertWarning").text("ลูกค้าร้าน " + data[0].CUSNAM + "ไม่สามารถทำรายการสั่งซื้อสินค้าได้ กรุณาติดต่อแผนก Credit Control หรือ Sales Admin");
                                $("#myModalWarning").modal();
                                $("#cus").text(data[0].CUSNAM + " (" + data[0].CUSCOD + ") ไม่สามารถทำรายการสั่งซื้อสินค้าได้ กรุณาติดต่อแผนก Credit Control หรือ Sales Admin");
                                $('#cus').attr('title', data[0].Hierarchy2_Channel);
                                $("#addcus").text("");
                                $("#crlicusaac").text("");
                                $("#crlicustac").text("");
                                $("#crbarcusaac").text("");
                                $("#crbarcustac").text("");
                                $("#crlicusaacday").text("");
                                $("#crlicustacday").text("");
                                $("#crlicusrating").text("");

                                $("#selslm").val(data[0].SLMCOD);

                                $("#cushid").val(data[0].CUSCOD);
                                $("#cussend").val(data[0].CUSCOD);//checkcustomerบัญชีลูกค้า:
                                $("#nocusses").val(data[0].CUSCOD);//master key customer
                                return false;
                            }
                            else {
                                $("#cus").text(data[0].CUSNAM + " (" + data[0].CUSCOD + ")");
                                $('#cus').attr('title', data[0].Hierarchy2_Channel);
                                $("#addcus").text(data[0].ADDR_01 + (data[0].ADDR_02));

                                if (usertype == "6") {
                                    if (usrclmstaff == "1") {
                                        $("#crlicusaac").text("xxxx");
                                        $("#crlicustac").text("xxxx");
                                        $("#crlicusaac").text("xxxx");
                                        $("#crlicustac").text("xxxx");
                                        $("#crbarcusaac").text("xxxx");
                                        $("#crbarcustac").text("xxxx");
                                        $("#crlicusaacday").text("xxxx");
                                        $("#crlicustacday").text("xxxx");
                                        $("#crlicusrating").text("xxxx");

                                    } else {
                                        $("#crlicusaac").text(commaSeparateNumber(data[0].AACCrlimit));
                                        $("#crlicustac").text(commaSeparateNumber(data[0].TACCrlimit));
                                        $("#crbarcusaac").text(commaSeparateNumber(data[0].AACBalance));
                                        $("#crbarcustac").text(commaSeparateNumber(data[0].TACBalance));
                                        $("#crlicusaacday").text(data[0].AACPAYTRM);
                                        $("#crlicustacday").text(data[0].TACPAYTRM);
                                        $("#divrating").css("display", "");
                                        $("#crlicusrating").text(data[0].RATING);
                                    }
                                } else {
                                    $("#crlicusaac").text(commaSeparateNumber(data[0].AACCrlimit));
                                    $("#crlicustac").text(commaSeparateNumber(data[0].TACCrlimit));
                                    $("#crbarcusaac").text(commaSeparateNumber(data[0].AACBalance));
                                    $("#crbarcustac").text(commaSeparateNumber(data[0].TACBalance));
                                    $("#crlicusaacday").text(data[0].AACPAYTRM);
                                    $("#crlicustacday").text(data[0].TACPAYTRM);
                                    $("#divrating").css("display", "");
                                    $("#crlicusrating").text(data[0].RATING);
                                }

                                //$("#crlicusaac").text(commaSeparateNumber(data[0].AACCrlimit));
                                //$("#crlicustac").text(commaSeparateNumber(data[0].TACCrlimit));
                                //$("#crbarcusaac").text(commaSeparateNumber(data[0].AACBalance));
                                //$("#crbarcustac").text(commaSeparateNumber(data[0].TACBalance));
                                //$("#crlicusaacday").text(data[0].AACPAYTRM);
                                //$("#crlicustacday").text(data[0].TACPAYTRM);

                                $("#cushid").val(data[0].CUSCOD);
                                $("#selslm").val(data[0].SLMCOD);

                                $("#cussend").val(data[0].CUSCOD);//checkcustomerบัญชีลูกค้า:
                                $("#nocusses").val(data[0].CUSCOD);//master key customer

                                $('#dnow').html("คำนวณวงเงิน ณ วันที่:" + d + "/" + m + "/" + y);
                                getCreditcuskey(cusel);
                            }
                        }

                    }
                });
                // }

               // getcuschamt(cusel); //ยอดซื้อรวม
               // getcuschamt_child(cusel) //ยอดซื้อตามร้านค้า
               // getPromotion_Cus(cusel, 'yearly')//promotion
                //getWarrantyClaim_Cu(cusel) //WarrantyClaim
               // getbackord(cusel)//backorder
            } else if (cusel == "ALL") {

                countorder("", Slm)
                $("#cus").text("");
                $("#addcus").text("");
                $("#crlicusaac").text("");
                $("#crlicustac").text("");
                $("#crbarcusaac").text("");
                $("#crbarcustac").text("");
                $("#crlicusaacday").text("");
                $("#crlicustacday").text("");
                $("#crlicusrating").text("");

                $('#cus').attr('title', "");
                //$("#selslm").val(data[0].SLMCOD);

                $("#cushid").val("");
                $("#cussend").val("");//checkcustomerบัญชีลูกค้า:
                $("#nocusses").val("");//master key customer
                //cleardataselect()
                //getcuschamt(cusel); //ยอดซื้อรวม
                //getcuschamt_child(cusel) //ยอดซื้อตามร้านค้า
               // getPromotion_Cus(cusel, 'yearly')//promotion
              //  getWarrantyClaim_Cu(cusel) //WarrantyClaim
              //  getbackord(cusel)//backorder
            }
           // alert(cusel)

        });
        function getslmandcus() {

            $.ajax({
                url: '@Url.Action("Getdateslm", "DataCenter")',
                data: {

                },
                type: "POST",
                dataType: "JSON",
                success: function (data) {

                    var select = $("#selslm");
                    select.children().remove();
                    if (usertype == "1") {
                        select.append($("<option>").val("ALL").text("ALL Sales Man"));
                    }
                    $(data).each(function (index, item) {
                        select.append($("<option custyp=" + item.SLMCOD + ">").val(item.SLMCOD).text(item.SLMCOD + "|" + item.SLMNAM));
                    });
                }
            });
        }
        $(document).on("click", "#btnnot", function () {
            //chkcustomer()
            getslmandcus(); //get salesman
            var cusel = $("#cushid").val();
            $.ajax({
                url: '@Url.Action("GetdatabyCus", "DataCenter")',
                data: {
                    cusel: cusel
                },
                type: "POST",
                dataType: "JSON",
                success: function (data) {
                    $("#selslm").val(data[0].SLMCOD);
                    chkcustomer()
                }
            });
        });
        $(document).on("click", "#btnok", function () {
            // var cusel = $("#nocusses").val();
            var cusel = $(this).attr('cusdata');
            // $("#nocusses").val(data[0].CUSCOD);//master key customer
            // $.ajax({
            //    url: '@Url.Action("GetdatabyCus", "DataCenter")',
            //    data: {
            //        cusel: cusel
            //    },
            //    type: "POST",
            //    dataType: "JSON",
            //    success: function (data) {
            //typin = data[0].INACTIVE;

            // if (typin == "Y") {
            //    $("#smallModal").modal('hide');
            //    $("#textAlertWarning").empty();
            //    $("#textAlertWarning").text("ลูกค้าร้าน " + data[0].CUSNAM + "INACTIVE กรุณาติดต่อแผนก Credit Control หรือ Sales Admin");
            //    $("#myModalWarning").modal();
            //    $("#cus").text(data[0].CUSNAM + " (" + data[0].CUSCOD + ") INACTIVE กรุณาติดต่อแผนก Credit Control หรือ Sales Admin");
            //    $("#addcus").text("");
            //    $("#crlicusaac").text("");
            //    $("#crlicustac").text("");
            //    $("#crbarcusaac").text("");
            //    $("#crbarcustac").text("");
            //    $("#crlicusaacday").text("");
            //    $("#crlicustacday").text("");
            //    $("#cushid").val(data[0].CUSCOD);
            //    $("#cussend").val(data[0].CUSCOD);//checkcustomerบัญชีลูกค้า:
            //    $("#nocusses").val(data[0].CUSCOD);//master key customer

            //    $("#selslm").val(data[0].SLMCOD);

            // checkcustomerinactive(cuskey)
            //    return false;
            var retval = checkcustomerinactive(item)

            if (retval[0] == "1") {
                showalr(retval[1])
                return false;
            } else {
                $.ajax({
                    url: '@Url.Action("GetdatabyCus", "DataCenter")',
                    data: {
                        cusel: cusel
                    },
                    type: "POST",
                    dataType: "JSON",
                    success: function (data) {
                        //console.log(data);
                        $("#smallModal").modal('hide');

                        // $("#cus").text("Custome Code:" + data[0].CUSCOD + "  Customer Name" + data[0].CUSNAM);
                        $("#cus").text(data[0].CUSNAM + " (" + data[0].CUSCOD + ")");
                        $("#addcus").text(data[0].ADDR_01 + (data[0].ADDR_02));
                        $("#crlicusaac").text(commaSeparateNumber(data[0].AACCrlimit));
                        $("#crlicustac").text(commaSeparateNumber(data[0].TACCrlimit));
                        $("#crbarcusaac").text(commaSeparateNumber(data[0].AACBalance));
                        $("#crbarcustac").text(commaSeparateNumber(data[0].TACBalance));
                        $("#crlicusaacday").text(data[0].AACPAYTRM);
                        $("#crlicustacday").text(data[0].TACPAYTRM);
                        $("#divrating").css("display", "");
                        $("#crlicusrating").text(data[0].RATING);
                        $("#cushid").val(data[0].CUSCOD);
                        $("#cussend").val(data[0].CUSCOD);//checkcustomerบัญชีลูกค้า:
                        $("#nocusses").val(data[0].CUSCOD);//master key customer
                        $("#selslm").val(data[0].SLMCOD);
                        datacus(data[0].SLMCOD);

                    }
                });
            }
            // }

            //});


        });


        $(document).on("click", "#nextsp", function () {
            // var cuddroplist = $("#cussend").val();//checkcustomerบัญชีลูกค้า:
            var cuskey = $("#cushid").val();//checkcustomerบัญชีลูกค้า:
            //var cuskey = "";
            //cuskey = $("#nocusses").val();
            //var cusel = $("#cushid").val();
            //if (cuskey == "") {
            //    cuskey = cusel;
            //}

            //var cusel = $("#cus").html();

            if (cuskey == "") {
                //if(cuddroplist == ""){
                $("#textAlertWarning").empty();
                $("#textAlertWarning").text("กรุณาเลือกลูกค้าที่ต้องการ Shopping");
                $("#myModalWarning").modal();
                $("#myModal").modal('hide');
                return false;
            } else {

                var retval = checkcustomerinactive(cuskey)

                if (retval[0] == "1") {
                    showalr(retval[1])
                    return false;
                } else {
                    //window.location.replace("../Home/Index?numcuber=" + btoa(cuskey));
                    window.location.replace("../Orderlist/Index?numcuber=" + btoa(cuskey));
                }

            }

        });

        $(document).on("click", "#mapcu", function () {
            // var cuddroplist = $("#cussend").val();//checkcustomerบัญชีลูกค้า:
            var cuskey = $("#cushid").val();//checkcustomerบัญชีลูกค้า:
            //var cuskey = "";
            //cuskey = $("#nocusses").val();
            //var cusel = $("#cushid").val();
            //if (cuskey == "") {
            //    cuskey = cusel;
            //}

            //var cusel = $("#cus").html();

            if (cuskey == "") {
                window.location.replace("../CustomerMap/Index");
                return false;
            } else {
                window.location.replace("../CustomerMap/Index?numcuber=" + btoa(cuskey));
            }
        });
        $(document).on("click", "#nextspold", function () {
            var cuskey = $("#cushid").val();//checkcustomerบัญชีลูกค้า:
            if (cuskey == "") {
                //if(cuddroplist == ""){
                $("#textAlertWarning").empty();
                $("#textAlertWarning").text("กรุณาเลือกลูกค้าที่ต้องการ Shopping");
                $("#myModalWarning").modal();
                $("#myModal").modal('hide');
                return false;
            } else {
                var retval = checkcustomerinactive(cuskey)

                if (retval[0] == "1") {
                    showalr(retval[1])
                    return false;
                } else {
                    window.location.replace("../Shoppinglist/Index?numcuber=" + btoa(cuskey));
                }
                @*$.ajax({
                    url: '@Url.Action("GetdatabyCus", "DataCenter")',
                    data: {
                        cusel: cuskey
                    },
                    type: "POST",
                    dataType: "JSON",
                    success: function (data) {
                        checkcustomerinactive(cuskey)
                        //if (data.length > 0) {
                        //    typin = data[0].INACTIVE;

                        //    if (typin == "Y") {

                        //        $("#textAlertWarning").empty();
                        //        $("#textAlertWarning").text("ลูกค้าร้าน " + data[0].CUSNAM + "INACTIVE กรุณาติดต่อแผนก Credit Control หรือ Sales Admin");
                        //        $("#myModalWarning").modal();

                        //        return false;


                        //    } else {
                        //        window.location.replace("../Shoppinglist/Index?numcuber=" + btoa(cuskey));
                        //    }
                        //}
                    }
                });*@
            }

        });

        $(document).on("click", "#nextcheckstock", function () {
            var cuskey = $("#cushid").val();//checkcustomerบัญชีลูกค้า:

            if (cuskey == "") {
                window.location.replace("../SCStockSco/Index");
            } else {
                var retval = checkcustomerinactive(cuskey)

                if (retval[0] == "1") {
                    showalr(retval[1])
                    return false;
                } else {
                    window.location.replace("../SCStockSco/Index?numcuber=" + btoa(cuskey));
                }
                @*$.ajax({
                    url: '@Url.Action("GetdatabyCus", "DataCenter")',
                    data: {
                        cusel: cuskey
                    },
                    type: "POST",
                    dataType: "JSON",
                    success: function (data) {
                        checkcustomerinactive(cuskey)*@
                //if (data.length > 0) {
                //    typin = data[0].INACTIVE;

                //    if (typin == "Y") {

                //        $("#textAlertWarning").empty();
                //        $("#textAlertWarning").text("ลูกค้าร้าน " + data[0].CUSNAM + "INACTIVE กรุณาติดต่อแผนก Credit Control หรือ Sales Admin");
                //        $("#myModalWarning").modal();

                //        return false;


                //    } else {
                //        window.location.replace("../SCStockSco/Index?numcuber=" + btoa(cuskey));
                //    }
                //}
                //}
                //});
            }

        });
        //ปุ่มยอดซื้อ
        $(document).on("click", "#navbaramount", function () {
            window.location.replace("../CustomerDashboard/index");
        });
        //ปุ่มโปรโมชัน
        $(document).on("click", "#navbarpromotion", function () {
            window.location.replace("../CustomerDashboard/Promotion");
        });
        //ปุ่มสินค้าค้างส่ง
        $(document).on("click", "#navbarpending", function () {
            window.location.replace("../CustomerDashboard/PendingDeliver");
        });
        $('#navbarshowdetail').click(function () {

            var cuskey = $("#cushid").val();//checkcustomerบัญชีลูกค้า:

            var codval = $('#selslm').val();
            if (usertype != "6") {
                if (cuskey != "") {
                    var retval = checkcustomerinactive(cuskey)
                    if (retval[0] == "1") {
                        showalr(retval[1]) //csutomer block//
                        return false;
                    } else {
                        //Getdatacartslm(codval)
                        window.location.replace("../Cart/Index?numcuber=" + btoa(cuskey));
                    }

                } else {
                    Getdatacartslm(codval)
                }

            } else {
                if (cuskey != "") {
                    var retval = checkcustomerinactive(cuskey)
                    if (retval[0] == "1") {
                        showalr(retval[1]) //csutomer block//
                        return false;
                    } else {
                        //Getdatacartslm(codval)
                        window.location.replace("../Cart/Index?numcuber=" + btoa(cuskey));
                    }

                } else {
                    Getdatacartcus(cuskey)
                }
            }
        });
        function Getdatacartcus(cuskey) {
            $.ajax({
                url: '@Url.Action("Getdatailorderbycustomer", "DataCenter")',
                data: { codval: cuskey },

                type: "POST",
                dataType: "JSON",
                success: function (data) {
                    //console.log(data);
                    $("#ModalwConfirm").modal();

                    $("#wConfirm > tbody").empty();

                    for (var i = 0; i < data.Getdata.length; i++) {

                        var SubmithtmlPage = '<tr style="cursor: pointer;" cus="' + data.Getdata[i].val.customer + '"  slm="' + data.Getdata[i].val.salmman + '"  Countrow="' + data.Getdata[i].val.Countrow + '" ">';
                        SubmithtmlPage += '<td>' + data.Getdata[i].val.customer + "/" + data.Getdata[i].val.customername + '</td>';
                        SubmithtmlPage += '<td>' + data.Getdata[i].val.salmman + "/" + data.Getdata[i].val.salmmanname + '</td>';
                        SubmithtmlPage += '<td>' + data.Getdata[i].val.sumqty + '</td>';

                        SubmithtmlPage += '</tr>';
                        $('#wConfirm').prepend(SubmithtmlPage);
                    }


                }
            });
        }
        function Getdatacartslm(slmcod) {
            $.ajax({
                url: '@Url.Action("Getdatailorder", "DataCenter")',
                data: { codval: slmcod },

                type: "POST",
                dataType: "JSON",
                success: function (data) {
                    //console.log(data);
                    $("#ModalwConfirm").modal();

                    $("#wConfirm > tbody").empty();

                    for (var i = 0; i < data.Getdata.length; i++) {

                        var SubmithtmlPage = '<tr style="cursor: pointer;" cus="' + data.Getdata[i].val.customer + '"  slm="' + data.Getdata[i].val.salmman + '"  Countrow="' + data.Getdata[i].val.Countrow + '" ">';
                        SubmithtmlPage += '<td>' + data.Getdata[i].val.customer + "/" + data.Getdata[i].val.customername + '</td>';
                        SubmithtmlPage += '<td>' + data.Getdata[i].val.salmman + "/" + data.Getdata[i].val.salmmanname + '</td>';
                        SubmithtmlPage += '<td>' + data.Getdata[i].val.sumqty + '</td>';

                        SubmithtmlPage += '</tr>';
                        $('#wConfirm').prepend(SubmithtmlPage);
                    }

                }
            });
        }
        $('#btncheckord').click(function () {

            var codval = $('#selslm').val();
            if (codval == "ALL") {
                //alert("กรุณาเลือก Slmcod ");
                $("#textAlertWarning").empty();
                $("#textAlertWarning").text("กรุณาเลือกพนักงานขาย");
                $("#myModalWarning").modal();
                $("#myModal").modal('hide');
                return false;
            } else {
                //var codval = $('#Slm').val();
                $.ajax({
                    url: '@Url.Action("Getdatailorder", "DataCenter")',
                    data: { codval: codval },

                    type: "POST",
                    dataType: "JSON",
                    success: function (data) {
                        // //console.log(data);
                        $("#ModalwConfirm").modal();

                        $("#wConfirm > tbody").empty();

                        for (var i = 0; i < data.Getdata.length; i++) {

                            var SubmithtmlPage = '<tr style="cursor: pointer;" cus="' + data.Getdata[i].val.customer + '"  slm="' + data.Getdata[i].val.salmman + '"  Countrow="' + data.Getdata[i].val.Countrow + '" ">';
                            SubmithtmlPage += '<td>' + data.Getdata[i].val.customer + "/" + data.Getdata[i].val.customername + '</td>';
                            SubmithtmlPage += '<td>' + data.Getdata[i].val.salmman + "/" + data.Getdata[i].val.salmmanname + '</td>';
                            SubmithtmlPage += '<td>' + data.Getdata[i].val.sumqty + '</td>';

                            SubmithtmlPage += '</tr>';
                            $('#wConfirm').prepend(SubmithtmlPage);
                        }

                    }
                });
            }
        });
        $("#wConfirm").on("click", "tr", function () {
            var cus = $(this).attr('cus');
            var slm = $(this).attr('slm');
            if (cus == "") {
                //cuskey = cusel;
                $("#ModalwConfirm").modal('hide');
                $("#textAlertWarning").empty();
                $("#textAlertWarning").text("กรุณาเลือกลูกค้าที่ต้องการ Shopping");
                $("#myModalWarning").modal();
                $("#myModal").modal('hide');
                return false;
            } else {
                $("#ModalwConfirm").modal('hide');
                var retval = checkcustomerinactive(cus)
                if (retval[0] == "1") {
                    showalr(retval[1]) //csutomer block//
                    return false;
                } else {
                    //Getdatacartslm(codval)
                    window.location.replace("../Cart/Index?numcuber=" + btoa(cus));
                }

            }
        });
        $('#nextcrm').click(function () {
            // checkcustomerinactive(cuskey)
            // window.location.replace("../SrcSaleCoCrm/Index");
            var cuskey = $("#cushid").val();//checkcustomerบัญชีลูกค้า:
            var retval = checkcustomerinactive(cuskey)
            if (retval[0] == "1") {
                showalr(retval[1])
                return false;
            } else {
                window.location.replace("../SrcSaleCoCrm/Index");
            }
            @*$.ajax({
                url: '@Url.Action("GetdatabyCus", "DataCenter")',
                data: {
                    cusel: cuskey
                },
                type: "POST",
                dataType: "JSON",
                success: function (data) {
                    typin = data[0].INACTIVE;

                    if (typin == "Y") {

                        checkcustomerinactive(cuskey)


                    } else {
                        window.location.replace("../SrcSaleCoCrm/Index");ห
                    }
                }*@

            //});
        });
        $('#btnclear').click(function () {
            window.location.replace("../CustomerDashboard/Promotion");
        });
        $('#nextdas').click(function () {

            window.open('https://app.powerbi.com/view?r=eyJrIjoiZGZhMzcyZDQtNjE2ZC00NWIxLTk0NGMtMzM1NDJlYmIxZTY2IiwidCI6IjBjYzc5Nzg2LTAxMWItNDkwOS1hYjNjLTFlMDJjOTRmYTRmZSIsImMiOjEwfQ%3D%3D', 'name');
        });

        $('#nextkpi').click(function () {

            window.open('https://app.powerbi.com/view?r=eyJrIjoiZjc5YmU5ODctNDdlMy00NGI0LTk2MzItYjM5MmRmMzUxZTNiIiwidCI6IjBjYzc5Nzg2LTAxMWItNDkwOS1hYjNjLTFlMDJjOTRmYTRmZSIsImMiOjEwfQ%3D%3D', 'name');
        });
        $('#nextbck').click(function () {
            // checkcustomerinactive(cuskey)
            // window.location.replace("../SrcSaleCoCrm/Index");
            var cuskey = $("#cushid").val();//checkcustomerบัญชีลูกค้า:
            var retval = checkcustomerinactive(cuskey)
            if (retval[0] == "1") {
                showalr(retval[1])
                return false;
            } else {
                window.location.replace("../BackorderAll/Index");
            }

        });

        //$('.w3-bar-item w3-button btnpromotion').click(function (ev) {
        //    $('#menu ul li').removeClass('selected');
        //    $(ev.currentTarget).parent('li').addClass('selected');
        //});
        //$(".w3-bar-item w3-button btnpromotion").click(function () {
        //    alert(this.id);
        //});
        $('#btn_yearly').click(function () {
            $('#btn_yearly').css("background", "#ACE2E1");
             $('#btn_quater').removeAttr('style');
             $('#btn_other').removeAttr('style');
        });
        $('#btn_quater').click(function () {
            $('#btn_yearly').removeAttr( 'style' );
            $('#btn_quater').css("background", "#ACE2E1");
            $('#btn_other').removeAttr( 'style' );
        });
        $('#btn_other').click(function () {
            $('#btn_yearly').removeAttr('style');
            $('#btn_quater').removeAttr('style');
            $('#btn_other').css("background", "#ACE2E1");
        });

        function chkcustomer() {

            if (usertype != "6") {

                if (usertype == "5") {

                } else {
                    if (cuscod == "") {

                        $.ajax({
                            url: '@Url.Action("Getdateslm", "DataCenter")',
                            data: {

                            },
                            type: "POST",
                            dataType: "JSON",
                            success: function (data) {

                                var select = $("#selslm");
                                select.children().remove();
                                if (usertype == "1") {//sales co
                                    select.append($("<option>").val("ALL").text("ALL Sales Man"));
                                }
                                $(data).each(function (index, item) {
                                    select.append($("<option custyp=" + item.SLMCOD + ">").val(item.SLMCOD).text(item.SLMCOD + "|" + item.SLMNAM));
                                });
                                if (usertype == "2") { //sales
                                    getcus();
                                    var slmcod = $("#selslm").val();
                                    countorder("", slmcod);
                                    //Getdatacartslm(slmcod)

                                    getCompanyInformationbysalman(slmcod)
                                }
                            }
                        });
                        //var SubmithtmlPage = "";
                        //SubmithtmlPage += '<div class="card-body">';

                        //SubmithtmlPage += '<div class="mt--10">';
                        //SubmithtmlPage += '<div class="contact-btn">';
                        //SubmithtmlPage += '<button type="submit" class="fv-btn" id="nextsp" style="background-color: aqua;">';
                        //SubmithtmlPage += 'Shopping';
                        //SubmithtmlPage += '</button>';
                        //SubmithtmlPage += '</div>';
                        //SubmithtmlPage += '</div>';
                        //SubmithtmlPage += '<a href="#" id="nextspold"> >>>> Shopping เวอร์ชั่นเก่า >>>></a><br /><br />';

                        //SubmithtmlPage += '</div>';
                        //$('.appendbtnshopbysales').append(SubmithtmlPage);
                        //  window.location.replace("../Account/LogIn");
                    } else {

                        getslmandcus()
                        $.ajax({
                            url: '@Url.Action("GetdatabyCus", "DataCenter")',
                            data: {
                                cusel: cuscod
                            },
                            type: "POST",
                            dataType: "JSON",
                            success: function (data) {
                                //console.log(data);
                                // $("#cus").text("Custome Code:" + data[0].CUSCOD + "/" + data[0].CUSNAM);
                                $("#cus").text(data[0].CUSNAM + " (" + data[0].CUSCOD + ")");
                                $('#cus').attr('title', data[0].Hierarchy2_Channel);
                                $("#addcus").text(data[0].ADDR_01 + (data[0].ADDR_02));




                                $("#crlicusaac").text(commaSeparateNumber(data[0].AACCrlimit));
                                $("#crlicustac").text(commaSeparateNumber(data[0].TACCrlimit));
                                $("#crbarcusaac").text(commaSeparateNumber(data[0].AACBalance));
                                $("#crbarcustac").text(commaSeparateNumber(data[0].TACBalance));
                                $("#crlicusaacday").text(data[0].AACPAYTRM);
                                $("#crlicustacday").text(data[0].TACPAYTRM);
                                $("#divrating").css("display", "");
                                $("#crlicusrating").text(data[0].RATING);

                                $("#cushid").val(data[0].CUSCOD);
                                //$("#selslm").prepend(new Option(data[0].SLMCOD));
                                //$("#selslm").prepend(data[0].SLMCOD)
                                // $("#selslm").val(data[0].SLMCOD);
                                $("#cussend").val(data[0].CUSCOD);//checkcustomerบัญชีลูกค้า:
                                $("#nocusses").val(data[0].CUSCOD);

                                //$("#slmhid").val(data[0].SLMCOD);
                                //$('#selslm option[value="' + data[0].SLMCOD + '"]').prop("selected", true);
                                //$("#selslm").val(data[0].SLMCOD).change();
                                datacus(data[0].SLMCOD);  ///auto get customer to option select customer
                                countorder(data[0].CUSCOD, data[0].SLMCOD);
                                $('#dnow').html("คำนวณวงเงิน ณ วันที่:" + d + "/" + m + "/" + y);
                                getCreditcuskey(cuscod);//get เครดิตรร้านแม่
                                getCompanyInformationbysalman(data[0].SLMCOD);//Company Information




                                $.ajax({
                                    url: '@Url.Action("Getdateslmbysalmcod", "DataCenter")',
                                    data: {
                                        codeslm: data[0].SLMCOD
                                    },
                                    type: "POST",
                                    dataType: "JSON",
                                    success: function (data) {
                                        //console.log(data)
                                        optText = data[0].SLMCOD + "|" + data[0].SLMNAM;
                                        optValue = data[0].SLMCOD;
                                        // $('#selslm').prepend(new Option(optText, optValue));
                                        //$('#selslm option[value="' + optValue + '"]').prop("selected", true);
                                        // $("#SalepersonCode option[value='ALL']").remove();
                                        //$("#selslm option[value='ALL']").remove();
                                        $("#selslm").prepend($("<option custyp=" + data[0].SLMCOD + ">").val(data[0].SLMCOD).text(data[0].SLMCOD + "|" + data[0].SLMNAM));
                                        $("#selslm").val($("#selslm option:first").val());
                                        return false;
                                    }
                                });
                            }
                        });
                        /*
                        var SubmithtmlPage = "";
                        SubmithtmlPage += '<div class="card-body">';

                        SubmithtmlPage += '<div class="mt--10">';
                        SubmithtmlPage += '<div class="contact-btn">';
                        SubmithtmlPage += '<button type="submit" class="fv-btn" id="nextsp" style="background-color: aqua;">';
                        SubmithtmlPage += 'Shopping';
                        SubmithtmlPage += '</button>';
                        SubmithtmlPage += '</div>';
                        SubmithtmlPage += '</div>';
                        SubmithtmlPage += '<a href="#" id="nextspold"> >>>> Shopping เวอร์ชั่นเก่า >>>></a><br /><br />';

                        SubmithtmlPage += '</div>';
                        $('.appendbtnshopbysales').append(SubmithtmlPage);
                        */

                        //getcuschamt(cuscod) //charts
                        //getcuschamt_child(cuscod)//charts_child
                        //getPromotion_Cus(cuscod, 'yearly')//promotion

                        //getWarrantyClaim_Cu(cuscod) //WarrantyClaim
                        //getbackord(cuscod)//backorder
                    }
                }
            } else if (usertype == "6") {

                if (cuscod == ""){
                    $('#nextspold').css("display", "none");
                    //$('#h2title').html("พนักงานขาย");
                    $('#h2title').html("เลือกบัญชีร้านค้า");
                    $('#prvs').css("margin-top", "-39px");
                    $('#selslm').css("display", "none");
                    $('#btnshsche').css("display", "none");
                    $('#btnclear').css("display", "none");
                    $("#changepass").css("display", "block");
                    var cuslog = "";
                    $.ajax({
                        url: '@Url.Action("Getdatalogincustomer", "DataCenter")',
                        data: {},
                        type: "POST",
                        dataType: "JSON",
                        success: function (data) {
                            //console.log(data);


                            if (data.length == 1) {
                                $('#cushead').remove();
                                $('.caption').css("display", "none");
                                $('#prvs').css("display", "none");
                                /*
                                var SubmithtmlPage = "";
                                SubmithtmlPage += '<div class="card-body">';

                                SubmithtmlPage += '<div class="mt--10">';
                                SubmithtmlPage += '<div class="contact-btn">';
                                SubmithtmlPage += '<button type="submit" class="fv-btn" id="nextsp" style="background-color: aqua;">';
                                SubmithtmlPage += 'Shopping';
                                SubmithtmlPage += '</button>';
                                SubmithtmlPage += '</div>';
                                SubmithtmlPage += '</div>';


                                SubmithtmlPage += '</div>';
                                $('.appendbtnshop').append(SubmithtmlPage);
                                */
                            } else {
                                var select = $("#selcus");
                                select.children().remove();
                                // select.append($("<option>").val("ALL").text("ลูกค้าทั้งหมดของ "+ SLMt));
                                //select.append($("<option>").val("ALL").text("ลูกค้าทั้งหมดของ"));
                                $.each(data, function (key, value) {

                                    select.append('<option value=' + value.CUSCOD + '>' + value.CUSCOD + '|' + value.CUSNAM + "----ที่อยู่ " + value.ADDR_01 + " " + value.PRO + '</option>');
                                });
                                $('.selectpicker').selectpicker('refresh');
                                $(".caret").css("display", "none");


                            }
                            cuslog = data[0].CUSCOD;

                            //getcuschamt(cuslog) //charts
                            //getcuschamt_child(cuslog)//charts_child
                            //getPromotion_Cus(cuslog, 'yearly')//promotion
                            //getCompanyInformation(cuslog)//Company Information
                            //getWarrantyClaim_Cu(cuslog) //WarrantyClaim
                           // getbackord(cuslog)//backorder
                            $.ajax({
                                url: '@Url.Action("GetdatabyCus", "DataCenter")',
                                data: {
                                    cusel: cuslog
                                },
                                type: "POST",
                                dataType: "JSON",
                                success: function (data) {
                                    //console.log(data);
                                    if (data.length == 1) {
                                        //$("#cus").text("Custome Code" + data[0].CUSCOD + "  Customer Name" + data[0].CUSNAM);
                                        $("#cus").text(data[0].CUSNAM + " (" + data[0].CUSCOD + ")");
                                        $('#cus').attr('title', data[0].Hierarchy2_Channel);
                                        $("#addcus").text(data[0].ADDR_01 + (data[0].ADDR_02));


                                            if (usrclmstaff == "1") {

                                                $("#crlicusaac").text("xxxx");
                                                $("#crlicustac").text("xxxx");
                                                $("#crbarcusaac").text("xxxx");
                                                $("#crbarcustac").text("xxxx");
                                                $("#crlicusaacday").text("xxxx");
                                                $("#crlicustacday").text("xxxx");
                                                $("#crlicusrating").text("xxxx");
                                            } else {
                                                $("#crlicusaac").text(commaSeparateNumber(data[0].AACCrlimit));
                                                $("#crlicustac").text(commaSeparateNumber(data[0].TACCrlimit));
                                                $("#crbarcusaac").text(commaSeparateNumber(data[0].AACBalance));
                                                $("#crbarcustac").text(commaSeparateNumber(data[0].TACBalance));
                                                $("#crlicusaacday").text(data[0].AACPAYTRM);
                                                $("#crlicustacday").text(data[0].TACPAYTRM);
                                                $("#divrating").css("display", "");
                                                $("#crlicusrating").text(data[0].RATING);
                                            }

                                        //$("#crlicusaac").text(commaSeparateNumber(data[0].AACCrlimit));
                                        //$("#crlicustac").text(commaSeparateNumber(data[0].TACCrlimit));
                                        //$("#crbarcusaac").text(commaSeparateNumber(data[0].AACBalance));
                                        //$("#crbarcustac").text(commaSeparateNumber(data[0].TACBalance));
                                        //$("#crlicusaacday").text(data[0].AACPAYTRM);
                                        //$("#crlicustacday").text(data[0].TACPAYTRM);
                                        $("#cushid").val(data[0].CUSCOD);
                                        $("#selslm").val(data[0].SLMCOD);
                                        $("#cussend").val(data[0].CUSCOD);//checkcustomerบัญชีลูกค้า:
                                        $("#nocusses").val(data[0].CUSCOD);
                                        countorder(data[0].CUSCOD, data[0].SLMCOD);
                                        //datacus();  ///auto get customer to option select customer
                                        //Getdatacartcus(data[0].CUSCOD)
                                        getCreditcuskey(cuslog);//get เครดิตรร้านแม่
                                        $('#dnow').html("คำนวณวงเงิน ณ วันที่:" + d + "/" + m + "/" + y);
                                    } else {
                                        window.location.replace("../Account/LogIn");
                                    }
                                }
                            });
                        }
                    });
                    /*
                    var SubmithtmlPage = "";
                    SubmithtmlPage += '<div class="card-body">';

                    SubmithtmlPage += '<div class="mt--10">';
                    SubmithtmlPage += '<div class="contact-btn">';
                    SubmithtmlPage += '<button type="submit" class="fv-btn" id="nextsp" style="background-color: aqua;">';
                    SubmithtmlPage += 'Shopping';
                    SubmithtmlPage += '</button>';
                    SubmithtmlPage += '</div>';
                    SubmithtmlPage += '</div>';


                    SubmithtmlPage += '</div>';
                    $('.appendbtnshopbysales').append(SubmithtmlPage);
                    */
                    //window.location.replace("../Account/LogIn");
                } else {

                   // getcuschamt(cuscod) //charts
                    //getcuschamt_child(cuscod)//charts_child
                    //getPromotion_Cus(cuscod,'yearly')//promotion
                    //getWarrantyClaim_Cu(cuscod) //WarrantyClaim
                    //getbackord(cuscod)//backorder
                    $('#nextspold').css("display", "none");
                    //$('#h2title').html("พนักงานขาย");

                    $('#h2title').html("เลือกบัญชีร้านค้า");
                    $('#prvs').css("margin-top", "-39px");
                    $('#selslm').css("display", "none");

                    $('#btnshsche').css("display", "none");
                    $('#btnclear').css("display", "none");
                    $("#changepass").css("display", "block");
                    $.ajax({
                        url: '@Url.Action("Getdateslmbycustomer", "DataCenter")',
                        data: {
                            cuscod: cuscod
                        },
                        type: "POST",
                        dataType: "JSON",
                        success: function (data) {
                            //console.log(data);

                            $("#selslm").append($("<option custyp=" + data[0].SLMCOD + ">").val(data[0].SLMCOD).text(data[0].SLMCOD + "|" + data[0].SLMNAM));

                            $("#selslm").prop("disabled", true);
                            //datacus();  ///auto get customer to option select customer
                            getCompanyInformationbysalman(data[0].SLMCOD)//Company Information

                        }
                    });
                    @*$.ajax({
                        url: '@Url.Action("GetdataCuslogincus", "DataCenter")',
                        data: {
                            cusel: cuscod
                        },
                        type: "POST",
                        dataType: "JSON",
                        success: function (data) {


                            $("#chart-Salesman").text("Salesman:" + data[0].SLMNAM + " เบอร์ติดต่อ:" + data[0].SLMPhone);
                            $("#chart-SalesCo").text("SalesCo:" + data[0].SalesCo + " เบอร์ติดต่อ:" + data[0].SalesCoPhone);
                            //datacus();  ///auto get customer to option select customer
                        }
                    });*@
                    $.ajax({
                        url: '@Url.Action("GetdatabyCus", "DataCenter")',
                        data: {
                            cusel: cuscod
                        },
                        type: "POST",
                        dataType: "JSON",
                        success: function (data) {
                            //console.log(data);
                            if (data.length == 1) {

                                //$("#cus").text("Custome Code" + data[0].CUSCOD + "  Customer Name" + data[0].CUSNAM);
                                $("#cus").text(data[0].CUSNAM + " (" + data[0].CUSCOD + ")");
                                $('#cus').attr('title', data[0].Hierarchy2_Channel);
                                $("#addcus").text(data[0].ADDR_01 + (data[0].ADDR_02));
                                if (usrclmstaff == "1") {

                                    $("#crlicusaac").text("xxxx");
                                    $("#crlicustac").text("xxxx");
                                    $("#crbarcusaac").text("xxxx");
                                    $("#crbarcustac").text("xxxx");
                                    $("#crlicusaacday").text("xxxx");
                                    $("#crlicustacday").text("xxxx");
                                    $("#crlicusrating").text("xxxx");
                                } else {
                                    $("#crlicusaac").text(commaSeparateNumber(data[0].AACCrlimit));
                                    $("#crlicustac").text(commaSeparateNumber(data[0].TACCrlimit));
                                    $("#crbarcusaac").text(commaSeparateNumber(data[0].AACBalance));
                                    $("#crbarcustac").text(commaSeparateNumber(data[0].TACBalance));
                                    $("#crlicusaacday").text(data[0].AACPAYTRM);
                                    $("#crlicustacday").text(data[0].TACPAYTRM);
                                    $("#divrating").css("display", "");
                                    $("#crlicusrating").text(data[0].RATING);
                                }
                                //$("#crlicusaac").text(commaSeparateNumber(data[0].AACCrlimit));
                                //$("#crlicustac").text(commaSeparateNumber(data[0].TACCrlimit));
                                //$("#crbarcusaac").text(commaSeparateNumber(data[0].AACBalance));
                                //$("#crbarcustac").text(commaSeparateNumber(data[0].TACBalance));
                                //$("#crlicusaacday").text(data[0].AACPAYTRM);
                                //$("#crlicustacday").text(data[0].TACPAYTRM);
                                $("#cushid").val(data[0].CUSCOD);
                                $("#selslm").val(data[0].SLMCOD);
                                $("#cussend").val(data[0].CUSCOD);//checkcustomerบัญชีลูกค้า:
                                $("#nocusses").val(data[0].CUSCOD);
                                countorder(data[0].CUSCOD, data[0].SLMCOD);
                                //datacus();  ///auto get customer to option select customer
                                //Getdatacartcus(data[0].CUSCOD)
                                getCreditcuskey(cuscod);//get เครดิตรร้านแม่
                                $('#dnow').html("คำนวณวงเงิน ณ วันที่:" + d + "/" + m + "/" + y);
                            } else {
                                window.location.replace("../Account/LogIn");
                            }
                        }
                    });

                    $.ajax({
                        url: '@Url.Action("Getdatalogincustomer", "DataCenter")',
                        data: {},
                        type: "POST",
                        dataType: "JSON",
                        success: function (data) {
                            //console.log(data);
                            if (data.length == 1) {
                                $('#cushead').remove();
                                $('.caption').css("display", "none");
                                $('#prvs').css("display", "none");
                                $("#selcus").prop("disabled", true);
                                /*
                                var SubmithtmlPage = "";
                                SubmithtmlPage += '<div class="card-body">';

                                SubmithtmlPage += '<div class="mt--10">';
                                SubmithtmlPage += '<div class="contact-btn">';
                                SubmithtmlPage += '<button type="submit" class="fv-btn" id="nextsp" style="background-color: aqua;">';
                                SubmithtmlPage += 'Shopping';
                                SubmithtmlPage += '</button>';
                                SubmithtmlPage += '</div>';
                                SubmithtmlPage += '</div>';


                                SubmithtmlPage += '</div>';
                                $('.appendbtnshop').append(SubmithtmlPage);
                                */
                            } else {
                                $("#selcus").prop("disabled", false);
                                var select = $("#selcus");
                                select.children().remove();
                                // select.append($("<option>").val("ALL").text("ลูกค้าทั้งหมดของ "+ SLMt));
                                //select.append($("<option>").val("ALL").text("ลูกค้าทั้งหมดของ"));
                                $.each(data, function (key, value) {

                                    select.append('<option value=' + value.CUSCOD + '>' + value.CUSCOD + '|' + value.CUSNAM + "----ที่อยู่ " + value.ADDR_01 + " " + value.PRO + '</option>');
                                });
                                $('.selectpicker').selectpicker('refresh');
                                $(".caret").css("display", "none");
                                /*
                                var SubmithtmlPage = "";
                                SubmithtmlPage += '<div class="card-body">';

                                SubmithtmlPage += '<div class="mt--10">';
                                SubmithtmlPage += '<div class="contact-btn">';
                                SubmithtmlPage += '<button type="submit" class="fv-btn" id="nextsp" style="background-color: aqua;">';
                                SubmithtmlPage += 'Shopping';
                                SubmithtmlPage += '</button>';
                                SubmithtmlPage += '</div>';
                                SubmithtmlPage += '</div>';


                                SubmithtmlPage += '</div>';
                                $('.appendbtnshopbysales').append(SubmithtmlPage);
                                */
                            }
                        }
                    });
                }
            }
            return false;
        }
        $('#changepass').click(function () {
            if (usertype == "6") {
                window.location.replace("../ChangePassword/Index");
            }
        });
    </script>
    <script src="~/Scripts/carousel-slider/js/jssor.slider-28.1.0.min.js"></script>
</body>
</html>
